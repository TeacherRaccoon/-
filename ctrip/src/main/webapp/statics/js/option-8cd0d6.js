(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{418:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(410),a=n.n(r);function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(e,t,n,r){return(e=e.toString()).length<t&&(n=new Array(t).join(n||" "),e=r?(n+e).substr(-t):(e+n).substring(0,t)),e},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=e.handleZone(Date.now());if(t)if(/^\d+$/.test(t))t=e.handleZone(t);else if("object"===o(t)&&t instanceof e)return this.date=t;if("string"===typeof(t=t||n)){var r=/^(\d{4})\-?(\d{1,2})(?:\-(\d{1,2}))?/i;t.match(r)&&(t=t.replace(r,function(e,t,n,r){return"".concat(t,"/").concat(n||"01","/").concat(r||"01")}))}this.date=new Date(t)}var t,n,r;return t=e,(n=[{key:"addDay",value:function(e){return e=e||0,this.date.setDate(this.date.getDate()+e),this}},{key:"addMonth",value:function(e){return e=e||0,this.date.setMonth(this.date.getMonth()+e),this}},{key:"addHours",value:function(e){return e=e||0,this.date.setHours(this.date.getHours()+e),this}},{key:"addMinutes",value:function(e){return e=e||0,this.date.setMinutes(this.date.getMinutes()+e),this}},{key:"addSeconds",value:function(e){return e=e||0,this.date.setSeconds(this.date.getSeconds()+e),this}},{key:"addYear",value:function(e){return e=e||0,this.date.setYear(this.date.getFullYear()+e),this}},{key:"toBJZone",value:function(){return new e(e.handleZone(this.date.getTime()))}},{key:"setHours",value:function(){return this.date.setHours.apply(this.date,arguments),this}},{key:"valueOf",value:function(){return this.date}},{key:"getTime",value:function(){return this.date.valueOf()}},{key:"toString",value:function(){return this.date.toString()}},{key:"format",value:function(e){var t=this.date;return(e=e||"YYYY-MM-DD").replace(/Y+|M+|D+|H+|m+|s+/g,function(e){var n=e.substr(0,1),r=e.length;switch(n){case"Y":return t.getFullYear().toString().substr(4-r);case"M":return c(t.getMonth()+1,r,"0",!0);case"D":return c(t.getDate(),r,"0",!0);case"H":return c(t.getHours(),r,"0",!0);case"m":return c(t.getMinutes(),r,"0",!0);case"s":return c(t.getSeconds(),r,"0",!0)}})}},{key:"diffMonth",value:function(t){var n=parseInt(this.format("YYYY"),10),r=parseInt(this.format("MM"),10),a=new e(t);return 12*(parseInt(a.format("YYYY"),10)-n)+(parseInt(a.format("MM"),10)-r)}},{key:"toCNweek",value:function(){return["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][this.date.getDay()]}}])&&i(t.prototype,n),r&&i(t,r),e}();Object.assign(s,{parse:function(e,t){return"object"===o(e)?(e instanceof s&&(e=e.valueOf()),t?new Date(e):new s(e)):((e+="").indexOf("Date")>-1&&(e=e.match(/(\d+)/)[0]),isNaN(e)||(e=parseInt(e)),t?new s(e).valueOf():new s(e))},dayDiff:function(e,t){var n=s.parse(e,!0),r=s.parse(t,!0);return n.setHours(0,0,0,0),r.setHours(0,0,0,0),parseInt((r-n)/864e5)},diffMonth:function(e,t){return(e=new s(e)).diffMonth(t)},format:function(e,t){return e=this.parse(e,!0),new s(e).format(t)},handleZone:function(e){if(!e||isNaN(e))return e;return+e+6e4*new Date(e).getTimezoneOffset()+288e5},inRangeTime:function(e,t){if(!e||!t)return!1;var n=e.split(":"),r=t.split(":"),o=a()().utc().utcOffset(8),i=o.hour(),c=o.minute(),s=60*n[0]+ +n[1],u=60*r[0]+ +r[1],l=60*i+ +c;return s>u?l>=s||l<=u:l<=s&&l>=u}})},419:function(e,t,n){"use strict";var r=n(424),a={html:{title:" \u91cd\u9009\u9152\u5e97 -\u3010\u643a\u7a0b\u81ea\u7531\u884c\u673a\u9152\u5957\u9910\u3011"},api:{test:"/mock/app-booking/json/test",submit:"/mock/app-booking/json/submitSuccess",upload:"/mock/app-booking/json/uploadSuccess",images:"/mock/app-booking/json/images",hotelListSearchMock:"/mock/app-booking/json/hotelListSearch",hotelListSearch:"/gateway/10705/HotelListSearch",getHotelFilterInfoMock:"/mock/app-booking/json/getHotelFilterInfo",getHotelFilterInfo:"/gateway/13078/json/getHotelFilterInfo",roomListSearchMock:"/mock/app-booking/json/roomListSearch",roomListSearch:"/frt/frt-newshopping-engine-ws/api/recommend/json/RoomListSearch",hotelDetailPolicies:"/frt/FRT-newShopping-Engine-WS/api/recommend/json/HotelDetail",hotelAssociationMock:"/mock/app-booking/json/hotelAssociation",hotelAssociation:"/hotel/autocomplete/search",hotelRoomUpdateMock:"/mock/app-booking/json/updateHotel",shoppingDetailMock:"/mock/app-booking/json/shoppingDetailGet",shoppingDetail:"/gateway/10705/ShoppingDetailGet",shoppingDetailUpdate:"/frt/FRT-newShopping-Engine-WS/api/recommend/json/ShoppingDetailUpdate",roomTaxFellInfoSearch:"/frt/FRT-newShopping-Engine-WS/api/recommend/json/RoomTaxFeeInfoSearch",getOrderCommentTempletForH5:"/gateway/12506/getOrderCommentTempletForH5",flightSearchMock:"/mock/app-booking/json/flightSearch",flightSearch:"/frt/frt-newShopping-engine-ws/api/recommend/json/FlightSearch",flightSearchMoreCabinMock:"/mock/app-booking/json/flightSearchMoreCabin",domesticRemarkSearch:"/gateway/10705/DomesticRemarkSearch",fareRemarkSearch:"/frt/frt-newShopping-engine-ws/api/recommend/json/FareRemarkSearch",chrTrainSearch:"/gateway/10705/TrainSearch",chrShoppingDetail:"/gateway/10705/ShoppingDetailGet",chrStopStation:"/gateway/13592/GetStopStations",chrBookTrain:"/gateway/10705/ShoppingDetailUpdate",flightInfoSearch:"/gateway/13966/FlightInfoSearch",flightSeatSearch:"/gateway/13966/FlightSeatSearch",internationalExtSearch:"/gateway/13966/InternationalExtendSearch",internationalRemarkSearch:"/gateway/13966/InternationalRemarkSearch",AB_TestURL:"/gateway/12446/GetABPreInfo.json"}},o=n(420),i=n.n(o),c=n(153),s=n.n(c),u=n(418);function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v(e,t,n[t])})}return e}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t,n){return(h="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return b});var b=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,c=new Array(o),s=0;s<o;s++)c[s]=arguments[s];return r=this,a=(e=g(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==l(a)&&"function"!==typeof a?m(r):a,v(m(n),"Loading",S),v(m(n),"traceLog",function(e,t,r){n.context.isServer||("undefined"===typeof window.__bfi&&(window.__bfi=[]),"string"!==typeof t&&(t=JSON.stringify(t)),window.__bfi.push(["_tracklog",e,t,r]))}),v(m(n),"send",function(e,t,r){if(!n.context.isServer)i.a.get("Servers_Eid"),u.a.format(new Date,"YYYY-MM-DD HH:mm:ss")}),n}var n,o,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,r["a"]),n=t,(o=[{key:"getInitialState",value:function(e){var t=this.location.query,n=void 0===t?{}:t,r=Object.keys(n).reduce(function(e,t){return e[t.toLowerCase()]=n[t],e},{});return p({},a,e,{query:r})}},{key:"fetch",value:function(){var e,n=(e=regeneratorRuntime.mark(function e(n,r){var a,o,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.context,o=a.locationOrigin,a.isClient&&(o=location.protocol+o),(r=r||{}).headers=r.headers||{},r.headers.cookieorigin=o,e.next=8,h(g(t.prototype),"fetch",this).call(this,n,r);case 8:if(i=e.sent,c=!0,r.notToUpperCase&&(c=!1),c&&(i=T(i)),!(s=i.ResponseStatus)||"Success"===s.Ack){e.next=15;break}return e.abrupt("return",Promise.reject(new Error(s.Errors[0].Message)));case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){d(o,r,a,i,c,"next",e)}function c(e){d(o,r,a,i,c,"throw",e)}i(void 0)})});return function(e,t){return n.apply(this,arguments)}}()},{key:"toUpperCase",value:function(e){}},{key:"init",value:function(){if(!1!==this.SSR)return h(g(t.prototype),"init",this).call(this);if(this.context.isClient)return window.__INITIAL_STATE__=void 0,h(g(t.prototype),"init",this).call(this);if(this.context.isServer){this.Loading;var e=this.initialState;return this.store={getState:function(){return e}},s.a.createElement(this.Loading,{state:e})}}},{key:"pvlog",value:function(e,t){this.context.isServer||("undefined"===typeof window.__bfi&&(window.__bfi=[]),window.__bfi.push(["_asynRefresh",p({page_id:e,url:location.href,orderid:"",refer:document.referrer},t)]))}}])&&f(n.prototype,o),c&&f(n,c),t}();function S(){return null}function T(e){if(Array.isArray(e))return e.map(T);if("[object Object]"!==Object.prototype.toString.call(e))return e;var t={};for(var n in e)t[n.charAt(0).toUpperCase()+n.substr(1)]=T(e[n]);return t}},852:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"initialState",function(){return fn}),n.d(r,"FORMAT_SHOPPINT_DETAILGET",function(){return mn}),n.d(r,"FORMAT_XSEARCH",function(){return hn}),n.d(r,"COUNT_DATE_CHANGE",function(){return gn}),n.d(r,"EXTEND_CHANGE",function(){return yn}),n.d(r,"FORMAT_PRICE_DETAIL",function(){return vn}),n.d(r,"SUBMIT",function(){return bn}),n.d(r,"SUBMIT_DATA_ERROR",function(){return Sn});var a=n(419),o=n(153),i=n.n(o),c=function(e){var t=e.data;return i.a.createElement("div",{className:"x_book_tips"},i.a.createElement("i",{className:"htl_icon_yes"}),"\u5df2\u4e3a\u60a8\u9009\u5230\u66f4\u4f4e\u4ef7\u7684\u673a\u7968\u5e76\u66ff\u6362\u539f\u6709\u63a8\u8350 "," ",i.a.createElement("a",{href:t.productUrl},"\u70b9\u51fb\u67e5\u770b"))};function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v(e,t,n[t])})}return e}function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function f(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?h(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){function t(){var e,n;l(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return v(h(n=f(this,(e=m(t)).call.apply(e,[this].concat(a)))),"state",{showList:!1}),v(h(n),"handleClick",function(e){n.props.handlers.handleExtendChange(e)}),v(h(n),"focus",function(e){n.setState({showList:!0})}),v(h(n),"blur",function(e){var t=setTimeout(function(){n.setState({showList:!1}),clearTimeout(t)},200)}),n}return g(t,o["Component"]),p(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.Name,r=t.ItemList,a=t.OrderExtendToken,o=t.Token,c=t.Type,s=this.state.showList,u="";r.some(function(e){var t=e.IsDefault,n=e.Content;if(t)return u=n,!0});var l=!1,d="num_select_status";return u||(d+=" input_error",l=!0),i.a.createElement("div",{className:"num_select_wrap"},i.a.createElement("div",{className:d,tabIndex:"0",onFocus:this.focus,onBlur:this.blur},i.a.createElement("span",null,!l&&u,l&&"\u8bf7\u9009\u62e9".concat(n)),i.a.createElement("i",null)),s&&i.a.createElement("div",{className:"num_select_dropdown"},r.map(function(t,n){var r=t.Content,s=t.IsDefault,u=t.OrderExtendItemToken;return i.a.createElement("a",{href:"javascript:;",className:s?"cur":"",key:n,onClick:e.handleClick.bind(e,{Token:o,Type:c,OrderExtendToken:a,OrderExtendItemToken:u})},r)})))}}]),t}(),S=function(e){function t(e){var n;l(this,t),v(h(n=f(this,m(t).call(this,e))),"select",function(e){var t=n.props.data,r=t.OrderExtendToken,a=t.Token,o=t.Type,i=n.state.list,c=[];i.map(function(e){var t=e.OrderExtendItemToken,n=e.IsDefault,r=e.Content;c.push({OrderExtendItemToken:t,IsDefault:n,Content:r})}),n.setState({showList:!1,listBak:c},function(){n.props.handlers.handleExtendChange({Token:a,OrderExtendToken:r,Type:o,selectList:i})})}),v(h(n),"focus",function(e){n.setState({showList:!0})}),v(h(n),"hideList",function(e){var t=n.state.listBak,r=[];t.map(function(e){var t=e.OrderExtendItemToken,n=e.IsDefault,a=e.Content;r.push({OrderExtendItemToken:t,IsDefault:n,Content:a})}),n.setState({showList:!1,list:r})}),v(h(n),"clickHandle",function(e){var t=e.OrderExtendItemToken,r=e.IsDefault,a=n.state.list;a.map(function(e){e.OrderExtendItemToken===t&&(e.IsDefault=!r)}),n.setState({list:a})});var r=[],a=[];return e.data.ItemList.map(function(e){var t={OrderExtendItemToken:e.OrderExtendItemToken,IsDefault:e.IsDefault,Content:e.Content};r.push(s({},t)),a.push(s({},t))}),n.state={showList:!1,list:r,listBak:a},n}return g(t,o["Component"]),p(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.Name,r=t.ItemList,a=this.state,o=a.showList,c=a.list,s=[];r.map(function(e){var t=e.IsDefault,n=e.Content;t&&s.push(n)});var u=!1,l="num_select_status";s.length?l+=" multi_num":(l+=" input_error",u=!0);var d=0;return c.map(function(e){e.IsDefault&&d++}),i.a.createElement("div",{className:"num_select_wrap"},i.a.createElement("div",{className:l,tabIndex:"0",onFocus:this.focus},!u&&s.map(function(e,t){return i.a.createElement("span",{key:t,className:0===t?"first-child":""},e)}),u&&i.a.createElement("span",null,"\u8bf7\u9009\u62e9",n),i.a.createElement("i",null)),o&&i.a.createElement("div",{className:"num_select_dropdown"},i.a.createElement("div",{className:"num_select_dropdown_hd"},i.a.createElement("a",{href:"javascript:;",className:"btn_s",onClick:this.select},"\u5b8c\u6210"),i.a.createElement("a",{href:"javascript:;",className:"btn_s btn_s_cancel",onClick:this.hideList},"\u53d6\u6d88"),i.a.createElement("p",null,"\u5df2\u9009\u62e9",i.a.createElement("strong",null,d),"\u6761")),i.a.createElement("div",{className:"num_select_dropdown_bd"},c.map(function(t,n){return i.a.createElement("a",{key:n,className:t.IsDefault?"cur":"",href:"javascript:;",onClick:e.clickHandle.bind(e,t)},t.Content,i.a.createElement("i",null))}))))}}]),t}(),T=function(e){function t(e){var n;return l(this,t),v(h(n=f(this,m(t).call(this,e))),"blur",function(e){var t=n.refs.textInput.value.trim(),r=n.props.data,a=r.Type,o=r.Token,i=r.OrderExtendToken;r.Content!==t&&n.props.handlers.handleExtendChange({Type:a,Content:t,Token:o,OrderExtendToken:i})}),n.state={Content:n.props.data.Content},n}return g(t,o["Component"]),p(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.data.Content;t!==this.state.Content&&this.setState({Content:t})}},{key:"render",value:function(){var e=this.props.data.Name,t=this.state.Content,n="input_text";return t||(n+=" input_error"),i.a.createElement("div",{className:"num_select_wrap"},i.a.createElement("div",{className:"num_input_status"},i.a.createElement("input",{type:"text",className:n,defaultValue:t||"",ref:"textInput",placeholder:"\u8bf7\u8f93\u5165".concat(e),onBlur:this.blur.bind(this)})))}}]),t}(),k=function(e){var t=e.data,n=e.handlers,r=t.OrderExtendInfos,a=t.Token;return i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"6"},i.a.createElement("div",{className:"sub_travel_form"},r.map(function(e,t){var r=e.Name,o=e.Type;return i.a.createElement("div",{className:"form_item",key:t},i.a.createElement("label",null,r),(1===o||3===o)&&i.a.createElement(b,{data:s({},e,{Token:a}),handlers:n}),2===o&&i.a.createElement(S,{data:s({},e,{Token:a}),handlers:n}),(4===o||5===o)&&i.a.createElement(T,{data:s({},e,{Token:a}),handlers:n}))}))))},P=n(154),C=n.n(P);function I(e){return(I="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return r=this,a=(e=E(t)).call.apply(e,[this].concat(i)),n=!a||"object"!==I(a)&&"function"!==typeof a?O(r):a,w(O(n),"handleSelected",function(e,t){e.value!==t&&(e.value=t);var r=Object.assign({},{selectedDate:t},n.props.callBackParams);r.propsprveSelectedDate!=t&&n.props.callBack(r)}),w(O(n),"regCelendar",function(e){if(n.mounted){var t=e||n.props,r=t.opts,a=(t.defaultDate,t.isEndDate),o=void 0!==a&&a,i=t.isDoubleCalendar,c=void 0!==i&&i,s=C.a.findDOMNode(O(n)),u=Object.assign({},{showAlways:!1,step:1,minDate:"1900-01-01",maxDate:null,defaultDate:null,showOptions:!1,showWeek:!1},r);u.defaultMonthDate&&(u.defaultDate=u.defaultMonthDate,cQuery(s).data("defaultDate",u.defaultMonthDate)),cQuery(s).data("minDate",u.minDate),cQuery(s).data("maxDate",u.maxDate),o||(u.permit=[]),c&&cQuery(s).data("permit",u.permit||[]),cQuery(s).data("prohibit",u.prohibit||[]),!!cQuery(s).getMod("calendar","6.0")||cQuery(s).regMod("calendar","6.0",{options:Object.assign({},u,{nextState:!0,container:cQuery.container}),listeners:{onChange:n.handleSelected}})}}),n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){this.mounted=!0,this.regCelendar()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"componentWillReceiveProps",value:function(e){this.mounted=!0,this.regCelendar(e)}},{key:"render",value:function(){var e=this.props,t=e.opts,n=e.name,r=e.data,a=e.className,o=t.isDisabled,c=void 0!==o&&o,s=r.placeholder;return c?i.a.createElement("input",{type:"text",name:n,value:t.defaultDate,className:a,placeholder:s,readOnly:!0,disabled:"disabled"}):i.a.createElement("input",{type:"text",name:n,value:t.defaultDate,className:a,placeholder:s,readOnly:!0})}}])&&D(n.prototype,r),a&&D(n,a),t}();function R(e){return(R="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=M(t).call(this,e),n=!a||"object"!==R(a)&&"function"!==typeof a?L(r):a,B(L(n),"checkInput",function(e){var t=n.props.list,r=!1;return t.some(function(t){if(e===t)return r=!0,!0}),r||(e=t[0]),e}),B(L(n),"focus",function(e){n.setState({isShowList:!0})}),B(L(n),"blur",function(e){var t=setTimeout(function(){n.setState({isShowList:!1}),clearTimeout(t)},200)}),B(L(n),"click",function(e){var t=n.state.count,r=n.props.otherParamsObj;t!==e&&n.setState({count:e},function(){n.props.change(e,r)})}),B(L(n),"change",function(e){var t=n.refs.input.value-0,r=n.props.otherParamsObj;isNaN(t)||(t=n.checkInput(t),n.state.count!==t&&n.setState({count:t},function(){n.props.change(t,r)}))}),n.state={isShowList:!1,count:e.count},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){var t=this.state.count,n=e.count;t!==n&&this.setState({count:n})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isShowList,r=t.count,a=this.props,o=a.list,c=a.disabled;return r===o[0]?!0:r===o[o.length-1]&&!0,i.a.createElement("div",{className:"num_input_wrap"},i.a.createElement("input",{type:"text",value:r,ref:"input",onFocus:this.focus,onBlur:this.blur,onChange:this.change,disabled:c}),i.a.createElement("b",null),n&&i.a.createElement("p",null,o.map(function(t){return i.a.createElement("a",{key:t,href:"javascript:;",rel:"nofollow",onClick:e.click.bind(e,t)},t)})))}}])&&x(n.prototype,r),a&&x(n,a),t}();function U(e){return(U="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q="".concat("x_input_text"," input_error"),q=function(e){var t=e.data,n=e.isTicket,r=e.sceneryDescription,a=e.sceneryAddInfos,o=e.tddTicketDescription,c="";if(n){c+=o||"",t.map(function(e){var t=e.SubTitle,n=e.ResourceAddInfoDetailList,r=e.AddInfoSubTitleName,a=e.Details,o="",i=[];n&&n.length&&(i=n),a&&a.length&&(i=a),i.length&&i.map(function(e){var t=e.DescDetail;o+=t}),c+="<h4>".concat(t||r,"</h4><p>").concat(o,"</p>")});var s="";a&&a.length&&(a.map(function(e){var t=e.AddInfoSubTitleName,n=e.AddInfoDetailList;s+="<h4>".concat(t,"</h4>"),n.map(function(e){var t=e.DescDetail;s+="<p>".concat(t,"</p>")})}),c+=s),r&&(c+="<p>".concat(r,"</p>"))}else{var u=t.Description,l=t.addList;c=u||"",l.map(function(e){e.map(function(e){var t=e.SubTitleName,n=e.DescDetail;c+="<h4>".concat(t||"","</h4></h3><p>").concat(n,"</p>")})})}return i.a.createElement("tr",{style:{display:"table-row"}},i.a.createElement("td",{colSpan:"6"},i.a.createElement("div",{className:"hidden_content"},i.a.createElement("i",{className:"arrow"}),i.a.createElement("div",{className:"detail_content_box",dangerouslySetInnerHTML:{__html:c}}))))},J=function(){return i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",{className:"td1"},"\u4ea7\u54c1\u540d\u79f0"),i.a.createElement("th",{className:"td2"},"\u5355\u4ef7"),i.a.createElement("th",{className:"td3"},"\u4f7f\u7528\u65e5\u671f"),i.a.createElement("th",{className:"td4"},"\u4efd\u6570"),i.a.createElement("th",{className:"td5"},"\u603b\u4ef7"),i.a.createElement("th",{className:"td6"})))},W=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=Y(t).call(this,e),n=!a||"object"!==U(a)&&"function"!==typeof a?F(r):a,G(F(n),"toggleAddinfos",function(e){n.setState({isShowAddinfo:!n.state.isShowAddinfo})}),G(F(n),"resourceType",function(e){var t=null;return e.isTicket?t="ticket":e.isRoom&&(t="room"),t}),G(F(n),"calendarChange",function(e,t){var r=n.props.data,a=r.Token,o=r.isTicket;(0,n.props.handlers.handleCountDateChange)({Token:a,type:t||"startDate",value:e.selectedDate,resourceType:n.resourceType({isTicket:o})})}),G(F(n),"calendarEndChange",function(e){n.calendarChange(e,"endDate")}),G(F(n),"countChange",function(e){var t=n.props.data,r=t.Token,a=t.isTicket,o=t.isRoom;(0,n.props.handlers.handleCountDateChange)({Token:r,type:"count",value:e,resourceType:n.resourceType({isTicket:a,isRoom:o})})}),n.state={isShowAddinfo:!1},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,o["Component"]),n=t,(r=[{key:"render",value:function(){var e=this.props.data,t=e.ResourceName,n=e.ChargeUnit,r=e.selectedCount,a=e.selectedDate,o=e.selectedPrice,c=e.selectedTradePrice,s=e.DescInfo,u=e.dfn,l=e.dateList,d=e.dateListProhibit,p=e.countList,f=e.IsPreferential,m=e.PeopleGroup,h=e.isTicket,g=e.isDoubleDate,y=e.isDisplayDate,v=e.startDateList,b=e.endDateList,S=e.selectedEndDate,T=e.CategoryId,P=e.OrderExtendInfos,C=e.datePlaceHolder,I=e.endDatePlaceHolder,D=e.Token,E=e.MinAge,O=e.MaxAge,_=e.sceneryAddInfos,w=e.sceneryDescription,R=e.isRoom,x=e.tddTicketDescription;e.isTradePrice&&(o=c);var M="x_input_text",L="x_input_text";r>0&&!a&&(M=Q),g&&(l=v,r>0&&!S&&(L=Q));var j=this.state.isShowAddinfo,B=null;f?B="\u7279\u60e0\u7968":m&&(B=function(e){var t="";return[{type:1,name:"\u6210\u4eba\u7968"},{type:2,name:"\u513f\u7ae5\u7968"},{type:8,name:"\u8001\u4eba\u7968"},{type:4,name:"\u5b66\u751f\u7968"},{type:16,name:"\u4f18\u5f85\u7968"},{type:32,name:"\u5bb6\u5ead\u7968"}].some(function(n){var r=n.type,a=n.name;if(e===r)return t=a,!0}),t}(m));var U=!1;s&&(x||_||w||s.length||s.Description||s.addList&&s.addList.length)&&(U=!0);var H=!1;return[2,6].indexOf(T)>=0&&E>=0&&O>0&&(H=!0),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",{className:"td1"},!!U&&i.a.createElement("a",{href:"javascript:;",onClick:this.toggleAddinfos},!!B&&i.a.createElement("span",{className:"x_ticket_type"},B),t),!U&&!!B&&i.a.createElement("span",{className:"x_ticket_type"},B),!U&&t,H&&i.a.createElement("p",{className:"x_book_notice"},"\u4ec5\u9650".concat(E,"-").concat(O,"\u5c81\u65c5\u5ba2\u9884\u8ba2"))),i.a.createElement("td",{className:"td2"},!!R&&i.a.createElement("span",null,"--"),!R&&i.a.createElement("span",{className:"ctrip_price",dangerouslySetInnerHTML:{__html:"".concat(u).concat(o)}})),y&&i.a.createElement("td",{className:"td3"},"--"),!y&&i.a.createElement("td",{className:"td3"},i.a.createElement(N,{opts:{defaultDate:a,minDate:l[0],maxDate:l[l.length-1],prohibit:d,showOptions:!0},data:{placeholder:C},className:M,name:"",callBack:this.calendarChange}),g&&i.a.createElement("span",{className:"x_line"}),g&&i.a.createElement(N,{opts:{defaultDate:S,minDate:b[0],maxDate:b[b.length-1],showOptions:!0},data:{placeholder:I},className:L,name:"",callBack:this.calendarEndChange})),i.a.createElement("td",{className:"td4"},i.a.createElement(A,{count:r,list:p,change:this.countChange.bind(this)}),n),i.a.createElement("td",{className:"td5"},!!R&&i.a.createElement("span",null,"--"),!R&&i.a.createElement("span",{className:"ctrip_price",dangerouslySetInnerHTML:{__html:"".concat(u).concat(r*o||0)}})),i.a.createElement("td",{className:"td6"},r>0&&i.a.createElement("i",{className:"htl_icon_yes"}))),U&&j&&i.a.createElement(q,{data:s,tddTicketDescription:x,sceneryDescription:w,sceneryAddInfos:_,isTicket:h}),r>0&&!!a&&!!P&&!!P.length&&i.a.createElement(k,{data:{OrderExtendInfos:P,Token:D},handlers:this.props.handlers}))}}])&&H(n.prototype,r),a&&H(n,a),t}();function V(e){return(V="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ne(e,t,n[t])})}return e}function z(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=["\u67e5\u770b","\u6536\u8d77"],ae=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=K(t).call(this,e),n=!a||"object"!==V(a)&&"function"!==typeof a?ee(r):a,ne(ee(n),"toggleSlide",function(e){n.setState({isSlide:!n.state.isSlide})}),ne(ee(n),"getsceneryInfo",function(e){try{var t=e.ResponseStatus,r=e.Data;if("Success"===t.Ack){var a=r.ImageList,o=r.AddInfos,i=null;a&&a.length&&(i=a[0].Url.replace(/^(http:|https:)/i,""));var c=[];o&&o.length&&o.map(function(e){var t=e.AddInfoSubTitleName,n=e.AddInfoDetailList;if("\u666f\u533a\u5730\u5740"===t||"\u5f00\u653e\u65f6\u95f4"===t){var r=n.map(function(e){return e.DescDetail});c.push({name:t,value:r.join("")})}}),n.setState({imgSrc:i,addressTime:c})}}catch(s){}}),ne(ee(n),"clickHandle",function(e){var t=n.props,r=t.data,a=r.POIId,o=r.ScenicSpotId;(0,t.handlers.handleToggleTicketModal)({POIId:a,ScenicSpotId:o,isShowTicketLayer:!0})});var o=e.data,i=o.isSdp,c=o.tickList,s=c.specialList,u=c.otherList,l=o.imgSrc,d=o.addressTime,p=[];u.map(function(e){e&&e.length&&(i?p=p.concat(e):p.push(e[0]))});var f=[].concat(z(s),z(p)),m=!1,h=0;return f.map(function(e){e.isHide&&h++}),h===f.length&&(m=!0),n.state={tickList:f,showList:!1,addressTime:d,imgSrc:l,isAllHide:m,showMore:f.length>3,isSlide:!1},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){if(!this.state.isAllHide){var e=this.props,t=e.handlers.handleSceneryInfo,n=e.data,r=n.imgSrc,a=n.POIId,o=n.ScenicSpotId;r||t({POIId:a,ScenicSpotId:o,count:0,imageCount:1,callBack:this.getsceneryInfo})}}},{key:"render",value:function(){var e=this,t=this.props.data,n=t.Name,r=t.CityInfo,a=t.CommentGrade,o=t.CommentCount,c=t.isLast,s=t.dfn,u=t.AddInfos,l=t.Description,d=t.isTradePrice,p=this.state,f=p.tickList,m=p.imgSrc,h=p.addressTime,g=p.isAllHide,y=p.showMore,v=p.isSlide;if(g)return null;m||(m="//pic.c-ctrip.com/vacation_v2/group_travel/place_hold_m.png");var b="x_book_tikect_mod";return c&&(b+=" last_tikect_mod"),y&&(v?f.map(function(e){e.isHide=!1}):f.map(function(e,t){t>=3&&e.selectedCount<=0&&(e.isHide=!0)})),i.a.createElement("div",{className:b},i.a.createElement("div",{className:"x_book_tikect"},i.a.createElement("a",{className:"tikect_img",href:"javascript:;",onClick:this.clickHandle},i.a.createElement("img",{src:m,alt:n})),i.a.createElement("h3",null,i.a.createElement("a",{href:"javascript:;",className:"tikect_title",onClick:this.clickHandle},n),i.a.createElement("i",null,"\u3010",r.CountryName,"-",r.CityName,"\u3011"),i.a.createElement("span",{className:"gap"},"|"),i.a.createElement("a",{href:"javascript:;",className:"score"},i.a.createElement("span",null,a,"\u5206")),i.a.createElement("i",null,o,"\u6761\u70b9\u8bc4")),!!h.length&&h.map(function(e,t){var n=e.name,r=e.value,a="".concat(n,":").concat(r);return i.a.createElement("p",{key:t,title:a,dangerouslySetInnerHTML:{__html:a}})})),i.a.createElement("table",{className:"x_book_table"},i.a.createElement(J,null),f.map(function(t,n){if(!t.isHide)return i.a.createElement(W,{handlers:e.props.handlers,key:n,data:Z({},t,{dfn:s,sceneryAddInfos:u,sceneryDescription:l,isTradePrice:d})})})),y&&i.a.createElement("div",{className:"flod_btn"},i.a.createElement("a",{href:"javascript:;",onClick:this.toggleSlide},v?re[1]:re[0],"\u5168\u90e8",i.a.createElement("i",{className:v?"down":"up"}))))}}])&&$(n.prototype,r),a&&$(n,a),t}(),oe=function(e){var t=e.data,n=e.handlers,r=t.resourceListTicket,a=r.CategoryName,o=r.sceneryList,c=t.dfn,s=t.isSdp,u=t.isTradePrice;return i.a.createElement("div",{className:"x_book_mod"},i.a.createElement("h4",{className:"x_book_tit"},a),o.map(function(e,t){return i.a.createElement(ae,{handlers:n,data:Z({},e,{dfn:c,isSdp:s,isTradePrice:u,isLast:t===o.length-1}),key:t})}))};function ie(e){return(ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ge(e,t,n[t])})}return e}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t,n){return t&&ue(e.prototype,t),n&&ue(e,n),e}function de(e,t){return!t||"object"!==ie(t)&&"function"!==typeof t?fe(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ye=["\u67e5\u770b","\u6536\u8d77"],ve=function(e){function t(e){var n;return se(this,t),ge(fe(n=de(this,pe(t).call(this,e))),"checkDoubleDate",function(e){var t=e.list,n=!1;return t.some(function(e){if(e.isDoubleDate)return n=!0,!0}),n}),ge(fe(n),"toggleSlide",function(e){n.setState({isSlide:!n.state.isSlide})}),n.state={showMore:e.data.list.length>4,isSlide:!1},n}return me(t,o["Component"]),le(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.CategoryName,r=t.list,a=t.dfn,o=t.tipsHtml,c=t.isTradePrice,s=this.state,u=s.showMore,l=s.isSlide,d="x_book_table";return this.checkDoubleDate({list:r})&&(d+=" x_book_wifi"),u&&(l?r.map(function(e){e.isHide=!1}):r.map(function(e,t){t>=4&&e.selectedCount<=0&&(e.isHide=!0)})),i.a.createElement("div",{className:"x_book_mod"},i.a.createElement("h4",{className:"x_book_tit"},n),i.a.createElement("table",{className:d},i.a.createElement(J,null),r.map(function(t,n){if(!t.isHide)return i.a.createElement(W,{handlers:e.props.handlers,key:n,data:ce({},t,{dfn:a,isTradePrice:c})})}),!!o&&i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"6"},i.a.createElement("div",{className:"luggage_limit_info",dangerouslySetInnerHTML:{__html:o}})))),u&&i.a.createElement("div",{className:"flod_btn"},i.a.createElement("a",{href:"javascript:;",onClick:this.toggleSlide},l?ye[1]:ye[0],"\u5168\u90e8",i.a.createElement("i",{className:l?"down":"up"}))))}}]),t}(),be=function(e){function t(e){var n;se(this,t),ge(fe(n=de(this,pe(t).call(this,e))),"rankResource",function(e){var t=[16,6,2],n=[],r=[],a=[],o=[],i=[];if(e&&e.length){var c=[].concat(t,[24,5,99,30,17,49,53,50,48]);e.map(function(e){c.indexOf(e.CategoryId)<0&&a.push(e)}),c.map(function(a,o){e.some(function(e){if(e.CategoryId===a)return t.indexOf(a)>=0?n[o]=e:r[o]=e,!0})}),n.length&&n.map(function(e){e&&o.push(e)}),r.length&&r.map(function(e){e&&i.push(e)})}return{firstResource:o,lastResource:[].concat(i,a)}});var r=n.rankResource(e.data.resourceList);return n.state=ce({},r),n}return me(t,o["Component"]),le(t,[{key:"render",value:function(){var e=this.props,t=e.handlers,n=e.data,r=n.resourceListTicket,a=n.dfn,o=n.isSdp,c=n.isTradePrice,s=this.state,u=s.firstResource,l=s.lastResource;return i.a.createElement("div",{className:"x_book_box"},i.a.createElement("h2",{className:"x_book_title"},i.a.createElement("span",null,i.a.createElement("i",null),"\u4e3a\u60a8\u63a8\u8350\u66f4\u591a\u5f53\u5730\u73a9\u4e50\u4ea7\u54c1")),!!u.length&&u.map(function(e,n){if(!e.isHide)return i.a.createElement(ve,{key:n,handlers:t,data:ce({},e,{dfn:a,isTradePrice:c})})}),!!r&&i.a.createElement(oe,{data:{resourceListTicket:r,dfn:a,isSdp:o,isTradePrice:c},handlers:t}),!!l.length&&l.map(function(e,n){if(!e.isHide)return i.a.createElement(ve,{key:n,handlers:t,data:ce({},e,{dfn:a,isTradePrice:c})})}))}}]),t}();function Se(e){return(Se="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=["\u4e0b\u4e00\u6b65","\u8bf7\u7a0d\u5019..."],De=function(e){function t(e){var n,r,a,o,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=ke(t).call(this,e),n=!a||"object"!==Se(a)&&"function"!==typeof a?Pe(r):a,o=Pe(n),c=function(e){n.state.canBook&&n.setState({canBook:!1},function(){n.props.handlers.handleSubmit()})},(i="clickHandler")in o?Object.defineProperty(o,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[i]=c,n.state={canBook:e.data.submitButton.canBook,buttonFixed:!1},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=null,n=window.innerHeight;window.onscroll=function(){t&&clearTimeout(t),t=setTimeout(function(){var t=!0;t=!(window.scrollY+n>=cQuery("#base_ft").offset().top-10),e.setState({buttonFixed:t})},16)}}},{key:"componentWillReceiveProps",value:function(e){var t=e.data,n=t.submitButton,r=t.hasRendered,a=this.state.canBook;r&&window.innerHeight&&document.body.clientHeight&&document.body.clientHeight/window.innerHeight>=1.2&&this.setState({buttonFixed:!0}),n.canBook!==a&&this.setState({canBook:n.canBook})}},{key:"render",value:function(){var e=this.state,t=e.canBook,n=e.buttonFixed,r=this.props.data.productUrl,a="defray_box layoutfix ";return n&&(a+=" defray_box_fix"),i.a.createElement("div",{className:a,style:{zIndex:9}},i.a.createElement("div",{className:"defray_shop_box"},i.a.createElement("a",{href:r,className:"prev_stop"},i.a.createElement("b",null),"\u4e0a\u4e00\u6b65"),i.a.createElement("span",{className:"x_defray_tips"},"\u66f4\u4e30\u5bcc\u7684\u5f53\u5730\u73a9\u4e50\u53ca\u95e8\u7968\u7528\u8f66\uff0c\u53ef\u5728\u4e0b\u5355\u540e\u7ee7\u7eed\u9884\u8ba2")),i.a.createElement("a",{href:"javascript:;",className:"btn_proess_big",onClick:this.clickHandler,id:"bst-10320656322-middle-fill"},t?Ie[0]:Ie[1]))}}])&&Te(n.prototype,r),a&&Te(n,a),t}();function Ee(e){return(Ee="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t){return!t||"object"!==Ee(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){xe(e,t,n[t])})}return e}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Me=function(e){var t=e.data,n=t.dfn,r=t.defaultPrice;return i.a.createElement("div",{className:"price_box price_sales"},i.a.createElement("span",{className:"price_item"},"\u5efa\u8bae\u5356\u4ef7"),i.a.createElement("strong",{className:"price_all",dangerouslySetInnerHTML:{__html:"".concat(n).concat(r)}}))},Le=function(e){var t=e.data,n=t.dfn,r=t.TotalPrice,a=t.save;return i.a.createElement("div",{className:"price_rental_box"},i.a.createElement("span",{className:"price_rental"},"\u603b\u989d"),i.a.createElement("div",{className:"price_number"},i.a.createElement("strong",{dangerouslySetInnerHTML:{__html:"".concat(n).concat(r)}}),a>0&&i.a.createElement("div",{className:"sheng"},i.a.createElement("span",{dangerouslySetInnerHTML:{__html:"\u7701".concat(n).concat(a)}}))))},je=function(e){var t=e.data,n=t.Name,r=t.Price,a=t.PriceType,o=t.dfn,c=t.details,s=t.isSdp,u="";return u=r>=0?"".concat(o).concat(r):"-".concat(o).concat(Math.abs(r)),i.a.createElement("li",null,i.a.createElement("div",{className:"box_show"},i.a.createElement("span",{className:"price_item"},n),2!==a&&i.a.createElement("span",{className:"price_detail",dangerouslySetInnerHTML:{__html:u}}),2===a&&i.a.createElement("span",{className:"price_detail present"},"(\u5e02\u573a\u4ef7",i.a.createElement("span",{className:"delete",dangerouslySetInnerHTML:{__html:u}}),")",i.a.createElement("span",{className:"price_red"},"\u514d\u8d39"))),i.a.createElement("dl",{className:"box_hidden"},1===a&&s&&i.a.createElement("dd",null,"\u5982\u60a8\u9884\u8ba2\u4e86\u673a\u7968\uff0c\u4ef7\u683c\u4e2d\u5df2\u542b\u6c11\u822a\u53d1\u5c55\u57fa\u91d1\u3001\u71c3\u6cb9\u8d39\u53ca\u7a0e\u8d39"),!!c&&c.map(function(e,t){var n=e.name,r=e.count,c=e.price,s=e.Days;if(e.isHotelTag)return i.a.createElement("dd",{key:t},i.a.createElement("span",{className:"price_item"},i.a.createElement("span",{className:"red-rights"},n)),i.a.createElement("span",{className:"price_detail",dangerouslySetInnerHTML:{__html:"-".concat(o).concat(c,"x").concat(r)}}));return i.a.createElement("dd",{key:t},i.a.createElement("span",{className:"price_item",title:n},n),"\u513f\u7ae5\u5ea7\u6905"!==n&&-2!==a&&i.a.createElement("span",{className:"price_detail",dangerouslySetInnerHTML:{__html:"".concat(c>=0?"".concat(o).concat(c,"x").concat(r):"-".concat(o).concat(Math.abs(c),"x").concat(r))}}),"\u513f\u7ae5\u5ea7\u6905"===n&&i.a.createElement("span",{className:"price_detail",dangerouslySetInnerHTML:{__html:"".concat(o).concat(c,"(").concat(r,"\u8f86\u4e2a) ")}}),-2===a&&i.a.createElement("span",{className:"price_detail",dangerouslySetInnerHTML:{__html:"".concat(o).concat(c,"x").concat(r,"\u95f4x").concat(s,"\u665a")}}))})))},Be=function(e){var t=e.data,n=t.dfn,r=t.list,a=t.isSdp;return i.a.createElement("ul",{className:"price_box scroll_y"},r.map(function(e,t){return i.a.createElement(je,{key:t,data:Re({},e,{dfn:n,isSdp:a})})}))},Ae=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_e(this,we(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){this.props.handlers.handleResourceRendered()}},{key:"render",value:function(){var e=this.props.data,t=e.dfn,n=e.PriceDetail,r=e.isTradePrice,a=e.isSdp,o=n.list,c=n.totalPrice,s=n.defaultPrice,u=n.save;return i.a.createElement("div",{className:"price_bar taocan_price_bar"},i.a.createElement("div",{className:"price_box_wrap"},i.a.createElement("div",{className:"price_wrap_content"},i.a.createElement("h3",null,"\u8d39\u7528\u660e\u7ec6"),i.a.createElement(Be,{data:{dfn:t,list:o,isSdp:a}}),i.a.createElement(Le,{data:{isTradePrice:r,dfn:t,TotalPrice:c,save:u}}),r&&i.a.createElement(Me,{data:{dfn:t,defaultPrice:s}}))))}}])&&Oe(n.prototype,r),a&&Oe(n,a),t}(),Ue=function(e){var t=e.data,n=e.handlers,r=t.location.query,a=t.productUrl,o=t.resourceList,s=t.resourceListTicket,u=t.dfn,l=t.isSdp,d=t.PriceDetail,p=t.submitButton,f=t.isTradePrice,m=t.hasRendered;return i.a.createElement("div",{className:"basefix"},i.a.createElement("div",{className:"book_main_box taocan_book_main"},2==r.lp&&i.a.createElement(c,{data:{productUrl:a}}),i.a.createElement(be,{data:{resourceList:o,dfn:u,resourceListTicket:s,isSdp:l,isTradePrice:f},handlers:n}),i.a.createElement(De,{data:{submitButton:p,productUrl:a,hasRendered:m},handlers:n})),!!d&&i.a.createElement(Ae,{handlers:n,data:{PriceDetail:d,dfn:u,isTradePrice:f}}))},He=function(){return i.a.createElement("ol",{className:"progress_bar"},i.a.createElement("li",{className:"complete"},i.a.createElement("i",null),"\u9009\u62e9\u4ea7\u54c1"),i.a.createElement("li",null,i.a.createElement("i",null),"\u586b\u5199\u4e0e\u6838\u5bf9"),i.a.createElement("li",null,i.a.createElement("i",null),"\u6210\u529f\u63d0\u4ea4"))},Ye=function(){return i.a.createElement("div",{className:"query"},i.a.createElement("img",{style:{verticalAlign:"middle"},src:"//pic.c-ctrip.com/common/loading_50.gif"}),"\u6b63\u5728\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u5019\u2026")};function Fe(e){return(Fe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e,t,n){return t&&Ge(e.prototype,t),n&&Ge(e,n),e}function qe(e,t){return!t||"object"!==Fe(t)&&"function"!==typeof t?We(e):t}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ve(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $e=function(e){function t(e){var n;return Xe(this,t),ze(We(n=qe(this,Je(t).call(this,e))),"prevChange",function(e){var t=n.state,r=t.imageNumber,a=t.currentIndex;--a<0&&(a=r-1),n.setState({currentIndex:a})}),ze(We(n),"nextChange",function(e){var t=n.state,r=t.imageNumber,a=t.currentIndex;++a>=r&&(a=0),n.setState({currentIndex:a})}),ze(We(n),"imageChange",function(e){n.setState({currentIndex:e})}),n.state={currentIndex:0,imageNumber:e.data.length},n}return Ve(t,o["Component"]),Qe(t,[{key:"render",value:function(){var e=this,t=this.state.currentIndex,n=this.props.data,r="//pic.c-ctrip.com/VacationOnlinePic/taocan/detail/default_img_big.png";return n.map(function(e,n){var a=e.Url;n===t&&(r=a)}),i.a.createElement("div",{className:"pic_loop"},i.a.createElement("div",{className:"big_pic"},i.a.createElement("img",{src:r.replace(/^(http:|https:)/i,""),width:"500",height:"280"}),i.a.createElement("a",{className:"prev",href:"javascript:;",onClick:this.prevChange}),i.a.createElement("a",{className:"next",href:"javascript:;",onClick:this.nextChange})),i.a.createElement("ul",{className:"small_pic"},n.map(function(n,r){var a=n.Url;return i.a.createElement("li",{key:r,className:r===t?"current":"",onClick:e.imageChange.bind(e,r)},i.a.createElement("img",{src:a?a.replace(/^(http:|https:)/i,""):"//pic.c-ctrip.com/vacation_v2/group_travel/detail_htl_hold.png",width:"92",height:"52"}),i.a.createElement("span",null,i.a.createElement("i",null)))})))}}]),t}(),Ke=function(e){var t=e.data;return i.a.createElement("div",{className:"user_comment"},i.a.createElement("h4",null,"\u7528\u6237\u70b9\u8bc4"),i.a.createElement("ul",null,t.map(function(e,t){var n=e.PublishTime,r=e.Nickname,a=e.Content;return i.a.createElement("li",{key:t},i.a.createElement("p",{className:"user_name"},i.a.createElement("span",null,n.split(" ")[0]||""),r||""),i.a.createElement("p",{className:"comment_detail"}," ",a))})))},et=function(e){var t=e.data,n=t.Name,r=t.CommentGrade,a=t.AddInfos,o=t.ImageList,c=t.CommentInfo;return a=function(e){var t=[];return e&&e.length&&e.map(function(e){switch(e.AddInfoSubTitleName){case"\u666f\u533a\u5730\u5740":t[0]=e;break;case"\u5f00\u653e\u65f6\u95f4":t[1]=e;break;case"\u4ea4\u901a\u4fe1\u606f":t[2]=e;break;case"\u4ea7\u54c1\u7ecf\u7406\u63a8\u8350":t[3]=e}}),t}(a),i.a.createElement("div",{className:"scene_detail_mask"},i.a.createElement("h3",null,i.a.createElement("a",{href:"javascript:;",className:"scene_title"},n)),r>0&&i.a.createElement("p",{className:"scene_score"},i.a.createElement("span",{className:"small_c"},i.a.createElement("span",{className:"b",style:{width:Math.floor(r/5*100)+"%"}})),i.a.createElement("span",{className:"sco"},i.a.createElement("strong",null,r),"/5\u5206")),!!a&&!!a.length&&a.map(function(e,t){var n=e.AddInfoSubTitleName,r=e.AddInfoDetailList.map(function(e){return e.DescDetail});return i.a.createElement("p",{key:t,dangerouslySetInnerHTML:{__html:"<b>".concat(n,"</b><br />").concat(r.join(" "))}})}),i.a.createElement("div",{className:"scene_mask_bottom basefix"},i.a.createElement($e,{data:o}),i.a.createElement(Ke,{data:c})))},tt=function(e){function t(e){var n;return Xe(this,t),ze(We(n=qe(this,Je(t).call(this,e))),"layerChange",function(e){var t=e||{},r=t.ResponseStatus,a=t.Data;r&&"Success"===r.Ack?n.setState({showLoading:!1,renderData:a}):n.props.close()}),n.state={showLoading:!0,renderData:null},n}return Ve(t,o["Component"]),Qe(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=t.POIId,r=t.ScenicSpotId;(0,e.handlers.handleSceneryInfo)({POIId:n,ScenicSpotId:r,count:100,imageCount:5,callBack:this.layerChange})}},{key:"render",value:function(){var e=this.props.close,t=this.state,n=t.showLoading,r=t.renderData;return i.a.createElement("div",{className:"resource_mask"},i.a.createElement("a",{href:"javascript:;",className:"close",onClick:e},i.a.createElement("span",null,"\u5173\u95ed")),n&&i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("img",{src:"//pic.c-ctrip.com/packages111012/loading_50-0816.gif"})),!n&&i.a.createElement(et,{data:r}))}}]),t}(),nt=function(e){function t(){var e,n;Xe(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return ze(We(n=qe(this,(e=Je(t)).call.apply(e,[this].concat(a)))),"container",null),ze(We(n),"createContainer",function(){if(!n.container){var e=n.props,t=e.data,r=e.handlers;n.container=document.createElement("div"),document.body.appendChild(n.container),C.a.render(i.a.createElement(tt,{data:t,handlers:r,close:n.close}),n.container),cQuery(n.container).mask()}}),ze(We(n),"close",function(e){cQuery(n.container).unmask(),C.a.unmountComponentAtNode(n.container),n.container=null,n.props.handlers.handleToggleTicketModal({POIId:null,ScenicSpotId:null,isShowTicketLayer:!1})}),n}return Ve(t,o["Component"]),Qe(t,[{key:"componentDidMount",value:function(){this.container||this.createContainer(),cQuery(this).mask()}},{key:"render",value:function(){return i.a.createElement("div",null)}}]),t}();function rt(e){return(rt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var st=function(e){function t(e){var n,r,a,o,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=ot(t).call(this,e),n=!a||"object"!==rt(a)&&"function"!==typeof a?it(r):a,o=it(n),c=function(e){cQuery("#J_modal").unmask(),n.props.handlers.handleCloseModal()},(i="closeModal")in o?Object.defineProperty(o,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[i]=c;var s=e.data.submitState.SupplyList[0].Value;return n.state={message:s},n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){cQuery("#J_modal").mask()}},{key:"render",value:function(){var e=this.state.message;return i.a.createElement("div",{className:"book_masking",id:"J_modal"},i.a.createElement("h2",null,i.a.createElement("a",{href:"javascript:;",onClick:this.closeModal}),"\u4fe1\u606f\u63d0\u793a"),i.a.createElement("div",{className:"book_masking_padding"},i.a.createElement("div",{className:"book_masking_content book_masking_content2"},i.a.createElement("i",{className:"icon_no"}),i.a.createElement("h3",null,e),i.a.createElement("div",{className:"masking_order_btn"},i.a.createElement("a",{href:"javascript:;",className:"btn_blue_middle",onClick:this.closeModal},"\u91cd\u65b0\u9009\u62e9")))))}}])&&at(n.prototype,r),a&&at(n,a),t}();function ut(e){return(ut="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mt=function(e){function t(){var e,n,r,a,o,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return r=this,a=(e=dt(t)).call.apply(e,[this].concat(u)),n=!a||"object"!==ut(a)&&"function"!==typeof a?pt(r):a,o=pt(n),c=function(e){cQuery(n.layer).unmask(),n.props.handlers.handleBestoneChannelHideTip()},(i="closeModal")in o?Object.defineProperty(o,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[i]=c,n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,o["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){this.layer=C.a.findDOMNode(this),cQuery(this.layer).mask()}},{key:"render",value:function(){var e=this.props.handlers.handleChangeBestoneType,t=1===this.props.data.bestoneType?2:1;return i.a.createElement("div",{className:"route_book_masking"},i.a.createElement("h2",null,"\u6e29\u99a8\u63d0\u793a"),i.a.createElement("div",{className:"route_masking_padding"},i.a.createElement("div",{className:"route_masking_content route_masking_content2"},i.a.createElement("h3",{style:{textAlign:"center"}},"\u5f53\u524d\u8d26\u6237\u5df2\u5207\u6362\u4ef7\u683c\u6a21\u5f0f\uff0c\u8bf7\u70b9\u51fb\u786e\u5b9a\u66f4\u65b0\u4ef7\u683c\u3002"),i.a.createElement("div",{className:"route_order_btn"},i.a.createElement("a",{href:"javascript:void(0)",className:"route_blue_middle",onClick:function(e,t){t!=e.type&&e.callback(e.type),e.close()}.bind(this,{type:t,bestoneType:t,callback:e,close:this.closeModal})},"\u786e\u5b9a")))))}}])&&lt(n.prototype,r),a&&lt(n,a),t}(),ht=n(487),gt=n(540),yt=n(454);function vt(e){var t=e.state,n=e.handlers,r=t.startLoading,a=t.isShowTicketLayer,o=t.isBestone,c=t.bestoneType,s=t.bstCookieName,u=t.submitState,l=t.isShowBestoneTip,d=t.isTradePrice,p=t.isOffline,f=n.handleChangeBestoneType,m=n.handleBestoneChannelCheckTip;return i.a.createElement("div",{className:d?"green_bestone_main":""},p&&i.a.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:".cui_hd_cont {display: none}"}}),p&&i.a.createElement(yt.a,{data:t,isHideMoreInfo:!0}),o&&i.a.createElement("link",{href:"/tour/static/app-detail/css/bestone_group.css",rel:"stylesheet",type:"text/css"}),o&&i.a.createElement(ht.b,{rootState:t}),o&&i.a.createElement(gt.a,{data:{bestoneType:c,bstCookieName:s},handlers:{handleChangeBestoneType:f,handleBestoneChannelCheckTip:m}}),i.a.createElement("div",{id:"base_bd",className:"main"},i.a.createElement(He,null),r&&i.a.createElement(Ye,null),!r&&i.a.createElement(Ue,{data:t,handlers:n}),a&&i.a.createElement(nt,{handlers:n,data:t})),o&&i.a.createElement(ht.a,null),u.isShowModal&&i.a.createElement(st,{handlers:n,data:t}),l&&i.a.createElement(mt,{handlers:n,data:t}))}var bt=function(e){var t=e.ResponseStatus,n=t.Errors;return"Success"!==t.Ack&&n},St=n(410),Tt=n.n(St);function kt(e){return(kt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ct=function(e,t,n,r){return(e=e.toString()).length<t&&(n=new Array(t).join(n||" "),e=r?(n+e).substr(-t):(e+n).substring(0,t)),e},It=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=e.handleZone(Date.now());if(t)if(/^\d+$/.test(t))t=e.handleZone(t);else if("object"===kt(t)&&t instanceof e)return this.date=t;if("string"===typeof(t=t||n)){var r=/^(\d{4})\-?(\d{1,2})(?:\-(\d{1,2}))?/i;t.match(r)&&(t=t.replace(r,function(e,t,n,r){return"".concat(t,"/").concat(n||"01","/").concat(r||"01")}))}this.date=new Date(t)}var t,n,r;return t=e,(n=[{key:"addDay",value:function(e){return e=e||0,this.date.setDate(this.date.getDate()+e),this}},{key:"addMonth",value:function(e){return e=e||0,this.date.setMonth(this.date.getMonth()+e),this}},{key:"addHours",value:function(e){return e=e||0,this.date.setHours(this.date.getHours()+e),this}},{key:"addMinutes",value:function(e){return e=e||0,this.date.setMinutes(this.date.getMinutes()+e),this}},{key:"addSeconds",value:function(e){return e=e||0,this.date.setSeconds(this.date.getSeconds()+e),this}},{key:"addYear",value:function(e){return e=e||0,this.date.setYear(this.date.getFullYear()+e),this}},{key:"toBJZone",value:function(){return new e(e.handleZone(this.date.getTime()))}},{key:"setHours",value:function(){return this.date.setHours.apply(this.date,arguments),this}},{key:"valueOf",value:function(){return this.date}},{key:"getTime",value:function(){return this.date.valueOf()}},{key:"toString",value:function(){return this.date.toString()}},{key:"format",value:function(e){var t=this.date;return(e=e||"YYYY-MM-DD").replace(/Y+|M+|D+|H+|m+|s+/g,function(e){var n=e.substr(0,1),r=e.length;switch(n){case"Y":return t.getFullYear().toString().substr(4-r);case"M":return Ct(t.getMonth()+1,r,"0",!0);case"D":return Ct(t.getDate(),r,"0",!0);case"H":return Ct(t.getHours(),r,"0",!0);case"m":return Ct(t.getMinutes(),r,"0",!0);case"s":return Ct(t.getSeconds(),r,"0",!0)}})}},{key:"diffMonth",value:function(t){var n=parseInt(this.format("YYYY"),10),r=parseInt(this.format("MM"),10),a=new e(t);return 12*(parseInt(a.format("YYYY"),10)-n)+(parseInt(a.format("MM"),10)-r)}},{key:"toCNweek",value:function(){return["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][this.date.getDay()]}}])&&Pt(t.prototype,n),r&&Pt(t,r),e}();function Dt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Ot(e,t,n[t])})}return e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.assign(It,{parse:function(e,t){return"object"===kt(e)?(e instanceof It&&(e=e.valueOf()),t?new Date(e):new It(e)):((e+="").indexOf("Date")>-1&&(e=e.match(/(\d+)/)[0]),isNaN(e)||(e=parseInt(e)),t?new It(e).valueOf():new It(e))},dayDiff:function(e,t){var n=It.parse(e,!0),r=It.parse(t,!0);return n.setHours(0,0,0,0),r.setHours(0,0,0,0),parseInt((r-n)/864e5)},diffMonth:function(e,t){return(e=new It(e)).diffMonth(t)},format:function(e,t){return e=this.parse(e,!0),new It(e).format(t)},handleZone:function(e){if(!e||isNaN(e))return e;return+e+6e4*(new Date).getTimezoneOffset()+288e5},inRangeTime:function(e,t){if(!e||!t)return!1;var n=e.split(":"),r=t.split(":"),a=Tt()().utc().utcOffset(8),o=a.hour(),i=a.minute(),c=60*n[0]+ +n[1],s=60*r[0]+ +r[1],u=60*o+ +i;return c>s?u>=c||u<=s:u<=c&&u>=s}});var _t=function(e){var t=e.Name,n=e.Token,r=e.ProductId,a=e.BMStatus,o=e.Category,i=e.Shoppings[0],c=i.MaxCount,s=i.SelectedCount,u=i.AdultSelectedCount,l=i.UnitPrice;return{Name:t,Token:n,ResourceId:r,BMStatus:a,CategoryId:o,MaxCount:c,SelectedCount:s,AdultSelectedCount:u,Price:{Price:l.Price,TradePrice:l.TradePrice,ChildPrice:l.ChildPrice,ChildTradePrice:l.ChildTradePrice,Save:l.Save,Original:l.Original},ResourceType:3}},wt=function(e){var t=e.shopping,n=t.UnitPrice,r=n.Price,a=n.TradePrice,o=n.ChildPrice,i=n.ChildTradePrice,c=n.Save,s=n.Original,u=t.MaxCount,l=t.UseDate;return{MaxCount:u,priceInfo:{Price:r,TradePrice:a,ChildPrice:o,ChildTradePrice:i,Save:c,Original:s,UseDate:It.parse(l).format("YYYY-MM-DD")}}},Nt=function(e){var t=e.Shoppings,n=e.selectedDate,r=e.selectedEndDate,a="",o=[],i=null;if(n)if(n&&r){var c=It.parse(n).getTime(),s=It.parse(r).getTime();t.map(function(e){if(It.parse(e.UseDate).getTime()>=c&&It.parse(e.UseDate).getTime()<=s){var t=wt({shopping:e}),n=t.MaxCount,r=t.priceInfo;a=n,o.push(r)}})}else{t.some(function(e){if(It.parse(e.UseDate).getTime()===It.parse(n).getTime())return i=e,!0}),i||(i=t[0]);var u=wt({shopping:i}),l=u.MaxCount,d=u.priceInfo;a=l,o=[d]}else{i=t[0];var p=wt({shopping:t[0]}),f=p.MaxCount,m=p.priceInfo;a=f,o=[m]}return{MaxCount:a,PriceList:o}},Rt=function(e){var t=e.Insurances,n=e.Hotels,r=e.ShoppingId,a=e.ProductId,o=e.SaleCityId,i=e.Passengers,c=e.requestParam,s=e.TradeCommission,u=e.Route,l=e.detailPriceList,d=e.mustPriceList,p=e.mustOptionPrice,f=e.resourceList,m=e.resourceListTicket,h=e.carPriceParam,g=e.trainPrice,y=e.UserInfo,v={};u&&u.Segments.length&&(v.Flight=function(e){var t=e.Route,n=t.IsIntl,r=t.Segments,a=[];return r[0].PriceInfos[0].PolicyGroups.map(function(e){var t=e.PassengerType,n=e.PriceDetail,r=n.Price,o=n.TradePrice,i=n.Oil,c=n.Tax;a.push({PriceType:t,Price:r,TradePrice:o,Oil:i,Tax:c})}),{IsIntl:n,PriceInfo:a}}({Route:u})),n&&n.length&&(v.Hotels=function(e){var t=e.Hotels,n=e.UserInfo,r=[];return t.map(function(e){var t=e.Basic,a=e.Token,o=e.Rooms,i=[];o.map(function(e){var t=e.RoomName,r=e.Token,a=e.Days,o=e.Shopping,c=o.DailyAveragePrice,s=o.DailyAverageTradePrice,u=o.DefaultCount,l=o.PkgPrice;l.CtripGroupDiscountName=n&&n.LeveName?"".concat(n.LeveName,"\u6743\u76ca"):"",i.push({RoomName:t,RoomToken:r,Price:c,TradePrice:s,Count:u,Days:a.length,PkgPrice:l})}),r.push({HotelName:t.HotelName,HotelToken:a,Rooms:i})}),r}({Hotels:n,UserInfo:y})),g&&g.length&&(v.Train=g);var b=[];t&&t.length&&(b=function(e){var t=e.Insurances,n=[];return t.map(function(e){var t=e.MainInsurance,r=e.AdditionalInsurances;n.push(_t(t)),r&&r.length&&r.map(function(e){n.push(_t(e))})}),n}({Insurances:t}));var S=[],T=[];if(f&&f.length){var k=function(e){var t=e.resourceList,n=[],r=[];return t.map(function(e){var t=e.list;t&&t.length&&t.map(function(e){var t=e.selectedCount,a=e.ResourceName,o=e.Token,i=e.ChargeUnit,c=e.BMStatus,s=e.Shoppings,u=e.selectedDate,l=e.isDoubleDate,d=e.selectedEndDate,p=e.MinBookingDays,f=e.isOption,m=e.ResourceId,h=e.CategoryId,g=e.IsSingleResource,y=e.IsChildNeedExtraPriceForNotShareRoom,v=e.IsHotelShareRoom,b=e.ProductQuantityRules;if(t&&h>0){var S={Name:a,Token:o,ChargeUnit:i,BMStatus:c,SelectedCount:t};if(f){u||(u=It.parse(s[0].UseDate).format("YYYY-MM-DD"));var T=Nt({Shoppings:s,selectedDate:u,selectedEndDate:d}).PriceList;r.push(Et({},S,{UseStartDate:u,UseEndDate:(l?d:u)||u,PriceInfo:T,MinBookingDays:p}))}else{var k=Nt({Shoppings:s,selectedDate:u}),P=k.MaxCount,C=k.PriceList;n.push(Et({},S,{ResourceId:m,CategoryId:h,IsSingleResource:g,IsChildNeedExtraPriceForNotShareRoom:y,IsHotelShareRoom:v,MaxCount:P,AdultSelectedCount:t,Price:C[0],QuantityRules:b,ResourceType:1}))}}})}),{otherList:n,ttdList:r}}({resourceList:f});S=k.otherList,T=k.ttdList}var P=[];m&&(P=function(e){var t=e.resourceListTicket,n=[],r=t.sceneryList;return r&&r.length&&r.map(function(e){var t=e.tickList,r=t.otherList,a=t.specialList;[].concat(Dt(r),[a]).map(function(e){e&&e.length&&e.map(function(e){var t=e.ResourceName,r=e.Token,a=e.BMStatus,o=e.CategoryId,i=e.ChargeUnit,c=e.selectedCount,s=e.ProductId,u=e.Shoppings,l=e.selectedDate;if(c>0){var d=Nt({Shoppings:u,selectedDate:l}).PriceList;n.push({Name:t,Token:r,ChargeUnit:i,ResourceId:s,BMStatus:a,CategoryId:o,MaxCount:"",SelectedCount:c,AdultSelectedCount:c,Price:d[0],ResourceType:1})}})})}),n}({resourceListTicket:m})),v.Others=[].concat(Dt(l),Dt(d),Dt(S),Dt(b),Dt(P),Dt(h)),v.TtdList=[].concat(Dt(T),Dt(p));var C=function(e){var t={};return e.map(function(e){var n=e.Type,r=e.Count,a=e.Ages;"Adult"===n?t.AdultCount=r:"Child"===n?(t.ChildCount=r,t.ChildAges=a):"Infant"===n&&(t.InfantCount=r)}),t}(i);return v.TradeCommission=s,Et({},c,{ShoppingId:r,ProductId:a,SaleCityId:o,Passenger:C,ReourceInfo:v})};function xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Lt=function(e){var t=e.Token,n=e.UseDate,r=e.UseEndDate;return{Token:t,Count:e.Shoppings[0].SelectedCount,UseDate:It.parse(n).format("YYYY-MM-DD"),UseEndDate:It.parse(r).format("YYYY-MM-DD")}},jt=function(e){var t=e.requestParam,n=e.ShoppingId,r=e.resourceList,a=e.resourceListTicket,o=e.XItemsShoppingDetail,i=e.Insurances,c=e.mustSelectOption,s=e.carSubmitParam,u=e.mustSelectRes,l=e.Header,d=e.isOffline,p=function(e){var t=e.mustSelectOption,n=[];return t&&t.length&&t.map(function(e){var t=e.SelectedCount,r=e.Token,a=e.UseStartDate,o=e.UseEndDate,i=e.OrderExtendInfos;n.push({Token:r,Count:t,UseDate:a,UseEndDate:o,OrderExtendInfos:i})}),n}({mustSelectOption:c}),f=function(e){var t=e.mustSelectRes,n=[];return t&&t.length&&t.some(function(e){var t=e.Token;e.Shoppings.some(function(e){var r=e.SelectedCount,a=e.UseDate,o=(e.DefaultCount,e.SegmentId),i=r;if(i>0){var c=It.parse(a).format("YYYY-MM-DD");return n.push({Token:t,Count:i,SegmentId:o,UseDate:c,UseEndDate:c}),!0}})}),n}({mustSelectRes:u}),m=function(e){var t=e.XItemsShoppingDetail,n=[];return t&&t.length&&t.map(function(e){var t=e.Token,r=e.Shoppings,a=e.SegmentId,o=r[0],i=o.SelectedCount,c=o.UseDate,s=It.parse(c).format("YYYY-MM-DD");n.push({Token:t,SegmentId:a,Count:i,UseDate:s,UseEndDate:s})}),n}({XItemsShoppingDetail:o}),h=function(e){var t=e.Insurances,n=[];return t&&t.length&&t.map(function(e){var t=e.MainInsurance,r=e.AdditionalInsurances,a=Lt(t);n.push(a),r&&r.length&&r.map(function(e){n.push(Lt(e))})}),n}({Insurances:i}),g=function(e){var t=e.resourceList,n=[],r=!1;return t&&t.length&&t.map(function(e){e.CategoryId>0&&e.list&&e.list.length&&e.list.map(function(e){var t=e.selectedCount,a=e.selectedDate,o=e.Token,i=e.SegmentId,c=e.isDoubleDate,s=e.selectedEndDate,u=e.OrderExtendInfos,l=e.isDisplayDate,d=e.Shoppings;if(t>0){if(l&&!a&&(a=It.parse(d[0].UseDate).format("YYYY-MM-DD")),!a||c&&!s)return r=!0,!1;var p={Token:o,SegmentId:i,Count:t,UseDate:a,UseEndDate:a};if(u&&u.length){var f=null;f=[],u.some(function(e){var t=e.OrderExtendToken,n=e.ItemList,a=e.Type,o=e.Content;if(4===a||5===a)o?f.push({OrderExtendToken:t,Content:o}):r=!0;else{var i=[],c=!1;n.map(function(e){var t=e.IsDefault,n=e.Content,r=e.OrderExtendItemToken;t&&(i.push({Content:n,OrderExtendItemToken:r}),c=!0)}),c||(r=!0),f.push({OrderExtendToken:t,ItemList:i})}}),p.OrderExtendInfos=f}c&&s&&(p.UseEndDate=s),n.push(p)}})}),!r&&n}({resourceList:r}),y=function(e){var t=e.resourceListTicket,n=[],r=!1;return t&&t.sceneryList&&t.sceneryList.map(function(e){var t=e.tickList,a=t.otherList,o=t.specialList,i=[].concat(Mt(a),[o]);i&&i.length&&i.map(function(e){e&&e.length&&e.map(function(e){var t=e.selectedCount,a=e.selectedDate,o=e.Token;if(t>0){if(!a)return r=!0,!1;n.push({Count:t,Token:o,UseDate:a,UseEndDate:a})}})})}),!r&&n}({resourceListTicket:a});if(!g||!y)return!1;var v=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){xt(e,t,n[t])})}return e}({},t,{IsCanBooking:!1,ShoppingId:n,ShoppingDetailUpdateRequest:{IsShoppingDetailUpdate:!0,ResourceType:0,SelectedResources:[].concat(Mt(m),Mt(h),Mt(g),Mt(y),Mt(p),Mt(f),Mt(s))},Channel:1,Version:"7152"});if(d){var b=[];l.some(function(e){if("uid"===e.Name.toLowerCase())return b.push({Key:"uid",Value:e.Value}),!0}),v.HeadTagList=b}return v};function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){At(e,t,n[t])})}return e}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ut=function(e){var t=e.CarInfo,n=[],r=[];if(t){var a=t.List;n=function(e){var t=e.List,n=[];return t.map(function(e){var t=e.CarProduct,r=t.Basic.ProductName,a=t.Token,o=t.SelectedCount,i=t.Price,c=i.Price,s=i.TradePrice,u=i.ChildPrice,l=i.ChildTradePrice,d=i.Save,p=i.Original,f=t.AddServiceList,m=null;f&&f.length&&(m=[],f.map(function(e){var t=e.SelectedCount,n=e.AddService,r=n.Name,a=n.Token,o=n.IsFirstFree,i=n.Price,c=i.Price,s=i.TradePrice;m.push({Name:r,Token:a,IsFirstFree:o,SelectedCount:t,Price:{Price:c,TradePrice:s}})}));var h={Name:r,Token:a,SelectedCount:o,Price:{Price:c,TradePrice:s,ChildPrice:u,ChildTradePrice:l,Save:d,Original:p},ResourceType:5};m&&(h.AddServiceList=m),n.push(h)}),n}({List:a}),r=function(e){var t=e.List,n=[];return t.map(function(e){var t=e.CarProduct,r=t.Token,a=t.SelectedCount,o=t.UseDate,i=t.AddServiceList,c=[];i.map(function(e){var t=e.SelectedCount,n=e.AddService;c.push({Count:t,AddServiceToken:n.Token})}),n.push({Token:r,Count:a,UseDate:It.parse(o).format("YYYY-MM-DD"),CarExtInfo:{AddServiceList:c}})}),n}({List:a})}return{carPriceParam:n,carSubmitParam:r}},Ht=function(e){if(bt(e))return{};var t=e.XItems,n=e.SaleCityId,r=e.ProductId,a=e.Passengers,o=e.Insurances,i=e.Hotels,c=e.DepartureDate,s=e.ShoppingId,u=e.Tickets,l=e.TradeCommission,d=e.Route,p=e.TTDOptionItems,f=e.CarInfo,m=e.TrainInfo,h=e.UserInfo,g=e.Header,y=r>0,v="/tour/detail/p".concat(r,"s").concat(n,".html?ShoppingId=").concat(s);y||(v="/tour/dp?ShoppingId=".concat(s));var b=[],S=[];t&&t.length&&t.map(function(e){var t=e.Basic,n=e.Token,r=e.Shoppings,a=t.ResourceId;t.IsSingleResource&&S.push(a);var o=r[0],i=o.SelectedCount,c=o.UseDate;i>0&&b.push({Token:n,SelectedCount:i,UseDate:c})});var T=[];u&&u.length&&u.map(function(e){var t=e.Token,n=e.DailyPrices[0],r=n.SelectedCount,a=n.UseDate;r>0&&T.push({Token:t,SelectedCount:r,UseDate:a})});var k=[];return p&&p.length&&p.map(function(e){var t=e.SelectedTTDOptionInfo,n=e.Token;k.push(Bt({},t,{Token:n}))}),Bt({},Ut({CarInfo:f}),{isSdp:y,DepartureDate:c,SaleCityId:n,ProductId:r,productUrl:v,Hotels:i,Insurances:o,ShoppingId:s,Passengers:a,TradeCommission:l,Route:d,trainPrice:function(e){var t=e.TrainInfo,n=[];return t.map(function(e){var t=e.ResourceCount,r=e.TrainExtPrice,a=e.TrainInfo,o=t.SelectedCount,i=a.TrainNo,c=a.FromStationName,s=a.ToStationName,u=a.SeatList[0],l=u.Token,d=u.SeatName,p=r.MaxPrice,f=p.Price,m=p.TradePrice,h=p.ChildPrice,g=p.ChildTradePrice,y=p.Save,v=p.Original;n.push(Et({},o,{TrainNo:i,FromStationName:c,ToStationName:s,Token:l,SeatName:d,Price:{Price:f,TradePrice:m,ChildPrice:h,ChildTradePrice:g,Save:y,Original:v}}))}),n}({TrainInfo:m}),resourceListSelected:[].concat(b,T,k),XItemsShoppingDetail:t,TTDOptionItems:p,singleResourceIds:S,UserInfo:h,Header:g})},Yt=function(e){return 1===(1&e)},Ft=function(e){return 2===(2&e)},Xt=function(e,t,n,r,a){if(!r)return!1;for(var o=[],i=It.parse(r).getTime(),c=i+864e5*(t-1),s=i+864e5*(n-1);s<=c;s+=864e5)o.push(It.parse(s).format("YYYY-MM-DD"));var u=o[o.length-1],l=It.parse(a[a.length-1].UseDate).format("YYYY-MM-DD");It.parse(u).getTime()>=It.parse(l).getTime()&&(u=l);var d=[];return o.map(function(e){It.parse(e).getTime()<=It.parse(l).getTime()&&d.push(e)}),d},Gt=function(e){return Math.min.apply(null,e)};function Qt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var qt=function(e){var t=e.XItems,n=e.OptionItems,r=e.resourceListSelected,a=[18,15,22,46],o=t||n,i=t||n,c=r.map(function(e){return e.Token});return i&&i.length&&(o=[],i.map(function(e){var t=e.Token,n=e.Basic,r=n.CategoryId,i=n.BMStatus,s=n.ParentCategoryId,u=n.IsSingleResource,l=e.Shoppings;if(u)return!1;if(c.indexOf(t)>=0)o.push(e);else{if(Yt(i))return!1;if(r=r||s,a.indexOf(r)>=0)return!1;if(l[0].UnitPrice.Price<=0)return!1;o.push(e)}})),o},Jt=function(e){var t=e.selectedDate,n=e.selectedEndDate,r=e.Shoppings,a=null;if(t&&n){a=0;var o=It.parse(t).getTime(),i=It.parse(n).getTime();r.map(function(e){var t=e.UnitPrice,n=e.UseDate,r=It.parse(n).getTime();r>=o&&r<=i&&(a+=Math.floor(t.Price))})}else if(!n){var c=It.parse(t).getTime();r.map(function(e){var t=e.UnitPrice,n=e.UseDate;It.parse(n).getTime()===c&&(a=Math.floor(t.Price)+"\u8d77")})}return a},Wt=function(e){var t=e.selectedDate,n=e.selectedEndDate,r=e.Shoppings,a=(e.isTradePrice,null);if(t&&n){a=0;var o=It.parse(t).getTime(),i=It.parse(n).getTime();r.map(function(e){var t=e.UnitPrice,n=e.UseDate,r=It.parse(n).getTime();r>=o&&r<=i&&(a+=Math.floor(t.TradePrice))})}else if(!n){var c=It.parse(t).getTime();r.map(function(e){var t=e.UnitPrice,n=e.UseDate;It.parse(n).getTime()===c&&(a=Math.floor(t.TradePrice)+"\u8d77")})}return a},Vt=function(e,t){return e&&e.length&&t&&t.length&&e.map(function(e){t.map(function(t){e.OrderExtendItemToken===t.OrderExtendItemToken&&(e.IsDefault=!0)})}),e},Zt=function(e){var t=e.Description,n=e.AddInfos,r=[];return n&&n.length&&n.map(function(e){var t=e.Details;r.push(t)}),{Description:t,addList:r}},zt=function(e){var t=e.Shoppings,n=[],r=[];if(t&&t.length){t.map(function(e){var t=e.UseDate;n.push(It.parse(t).format("YYYY-MM-DD"))});for(var a=It.parse(t[0].UseDate),o=It.parse(t[t.length-1].UseDate),i=0,c=a.getTime();c<=o.getTime();){r.push(It.parse(c).format("YYYY-MM-DD"));var s=new Date(c);if(c=s.setDate(s.getDate()+1),365===++i)break}if(n.length&&r.length&&n.length!==r.length){var u=[];return r.map(function(e){-1===n.indexOf(e)&&u.push(e)}),u}return[]}return n},$t=function(e){var t=e.Shoppings,n=[];return t&&t.length&&t.map(function(e){var t=e.UseDate;n.push(It.parse(t).format("YYYY-MM-DD"))}),n},Kt=function(e){var t=e.MinCount,n=e.MaxCount,r=e.StepCount,a=void 0===r?1:r,o=e.BMStatus,i=e.Category;a=a<=0?1:a;for(var c=[],s=t;s<=n;s+=a)c.push(s);var u=!1;return 1!==(1&o)&&(30!==i?u=!0:2!==a&&(u=!0)),u&&c[0]>0&&(c=[0].concat(Qt(c))),c},en=function(e){var t=e.selectedDate,n=e.Shoppings,r=e.BMStatus,a=e.CategoryId,o=(e.isTradePrice,0),i="",c="",s=[],u=!1;if(t||(t=It.parse(n[0].UseDate).format("YYYY-MM-DD")),t&&n&&n.length&&(n.some(function(e){var n=e.MaxCount,l=e.MinCount,d=e.SelectedCount,p=e.DefaultCount,f=e.StepCount,m=e.UnitPrice,h=e.UseDate;if(It.parse(t).getTime()===It.parse(h).getTime())return o=d||p,i=m.Price,c=m.TradePrice,s=Kt({MinCount:l,MaxCount:n,StepCount:f,BMStatus:r,Category:a}),u=!0,!0}),!u)){var l=n[0],d=l.MaxCount,p=l.MinCount,f=l.SelectedCount,m=l.StepCount,h=l.UnitPrice;i=h.Price,c=h.TradePrice,o=f,s=Kt({MinCount:p,MaxCount:d,StepCount:m,BMStatus:r,Category:a})}return{selectedCount:o,selectedPrice:i,selectedTradePrice:c,countList:s,hasDate:u}},tn=function(e,t,n){if(e&&e.length){var r=[];return e.map(function(e){var a=e.Name,o=e.CityInfo,i=e.CommentGrade,c=e.CommentCount,s=e.AddInfos,u=e.ImageList,l=e.POIId,d=e.ScenicSpotId,p=e.Description,f=e.TicketResourceInfos,m=null;u&&u.length&&(m=u[0].URL.replace(/^(http:|https:)/i,""));var h=[];s&&s.length&&s.map(function(e){var t=e.AddInfoSubTitleName,n=e.AddInfoDetailList;if("\u666f\u533a\u5730\u5740"===t||"\u5f00\u653e\u65f6\u95f4"===t){var r=n.map(function(e){return e.DescDetail});h.push({name:t,value:r.join("")})}});var g=function(e,t,n){var r=[];e&&e.length&&e.map(function(e){var a=e.Token,o=e.Shoppings,i=e.TicketResourceBasicInfo,c=e.isHide,s=i.Name,u=i.Unit,l=i.BMStatus,d=i.AddInfos,p=i.PeopleGroup,f=i.IsPreferential,m=i.DefaultUseDate,h=(i.FirstBookingDate,i.CategoryId),g=i.ProductId,y=i.Description;Yt(l)&&(c=!0);var v=$t({Shoppings:o}),b=zt({Shoppings:o}),S=m,T=!1,k=0;t.some(function(e){if(e.Token===a)return T=!0,S=It.parse(e.UseDate).format("YYYY-MM-DD"),k=e.SelectedCount,!0});var P=en({selectedDate:S,Shoppings:o,BMStatus:l,CategoryId:h,isTradePrice:n}),C=P.selectedCount,I=P.selectedPrice,D=P.selectedTradePrice,E=P.countList,O=P.hasDate;T||(k=C,O||(S="")),r.push({ResourceName:s,selectedPrice:I,selectedTradePrice:D,selectedDate:S,dateList:v,dateListProhibit:b,selectedCount:k,countList:E,ChargeUnit:u,DescInfo:d,tddTicketDescription:y,PeopleGroup:p,IsPreferential:f,Token:a,BMStatus:l,isTicket:!0,CategoryId:h,Shoppings:o,ProductId:g,datePlaceHolder:"\u8bf7\u9009\u62e9\u65e5\u671f",isHide:c})});var a=[],o=[[],[],[],[],[],[],[]];r.map(function(e){switch(e.PeopleGroup){case 1:o[0].push(e);break;case 2:o[1].push(e);break;case 3:o[2].push(e);break;case 4:o[3].push(e);break;case 5:o[4].push(e);break;case 6:o[5].push(e);break;default:o[6].push(e)}});var i=[];return o.map(function(e){if(e.length){var t=[];e.map(function(e,n){e.IsPreferential?a.push(e):t.push(e)}),i.push(t)}}),{specialList:a,otherList:i}}(f,t,n);r.push({Name:a,POIId:l,ScenicSpotId:d,imgSrc:m,CommentGrade:i,CommentCount:c,CityInfo:o,addressTime:h,tickList:g,AddInfos:s,Description:p})}),{CategoryName:"\u666f\u70b9\u95e8\u7968",sceneryList:r}}},nn=function(e){var t=e.list,n=[];return t&&t.length?(t.map(function(e){var t=e.Basic.BMStatus;if(Yt(t))return!1;n.push(e)}),n):t},rn=function(e,t,n,r,a,o){var i=[],c=e.XItems,s=e.TicketProducts,u=e.OptionItems;c=nn({list:c}),u=nn({list:u});var l=function(e){var t=e.XItems,n=[],r=[];return t&&t.length&&t.map(function(e){4===e.Basic.CategoryId?r.push(e):n.push(e)}),r.map(function(e){var t=e.Basic.BMStatus,n=e.Shoppings;Yt(t)&&(e.isHide=!0),n[0].UnitPrice.Price||(e.isHide=!0)}),{lastXItems:n,xTickets:r}}({XItems:c}),d=l.lastXItems,p=l.xTickets,f=function(e){var t=e.OptionItems;return t.map(function(e){e.defBasic=e.Basic;var t=e.Basic,n=t.OptionName,r=t.ProductId,a={CategoryName:t.ParentCategoryName,CategoryId:t.ParentCategoryId,ChargeUnit:t.ChargeUnit,ProductId:r,ProductName:n,BMStatus:t.BMStatus,MinAge:t.MinAge,MaxAge:t.MaxAge,MinBookingDays:t.MinBookingDays,MaxBookingDays:t.MaxBookingDays,isOption:!0};e.Basic=a}),t}({OptionItems:u}),m=[].concat(Qt(d),Qt(f));if((m=function(e){var t=e.allResList,n=e.singleResourceIds,r=[],a=[];if(t&&t.length&&(t.map(function(e){var t=e.Basic.IsSingleResource,n=e.ResourceRelations;t||(n.length?r.push(e):a.push(e))}),n.length&&r.length)){var o=[];return r.map(function(e){var t=e.ResourceRelations;if(t.length){var r=!1;t.some(function(e){var t=e.ResourceRelationID;if(n.indexOf(t)>=0)return r=!0,!0}),r&&o.push(e)}else o.push(e)}),[].concat(Qt(r=o),a)}return t}({allResList:m,singleResourceIds:a}))&&m.length){var h=[],g=[];m.map(function(e){var r,a,i=e.AddInfos,c=e.Basic,s=e.DefaultUseDate,u=e.Token,l=e.Shoppings,d=e.OrderExtendInfos,p=e.SegmentId,f=e.ResourceRelations,m=c.BMStatus,y=c.CategoryId,v=c.CategoryID,b=c.CategoryName,S=c.ChargeUnit,T=c.Description,k=c.ResourceName,P=c.ResourceId,C=c.ProductId,I=c.ProductName,D=c.MinBookingDays,E=c.MaxBookingDays,O=c.MinAge,_=c.MaxAge,w=c.isOption,N=c.IsSingleResource,R=c.IsHotelShareRoom,x=c.IsChildNeedExtraPriceForNotShareRoom,M=c.ProductQuantityRules;a=y=y||v,-1===(r=g).indexOf(a)&&r.push(a),g=r;var L=$t({Shoppings:l}),j=zt({Shoppings:l}),B=s;s&&L.indexOf(s)<0&&(B=L[0]);var A=!1,U="",H=0,Y=!1;t.some(function(e){if(e.Token===u)return A=!0,B=It.parse(e.UseDate||e.UseStartDate).format("YYYY-MM-DD"),e.UseEndDate&&(U=It.parse(e.UseEndDate).format("YYYY-MM-DD")),H=e.SelectedCount,Y=!0,!0}),Y||n.some(function(e){if(e.Token===u){var t=e.SelectedTTDOptionInfo,n=t.OrderExtendInfos,r=t.SelectedCount,a=t.UseEndDate,o=t.UseStartDate;return A=!0,H=r,U=It.parse(a).format("YYYY-MM-DD"),B=It.parse(o).format("YYYY-MM-DD"),d&&d.length&&n&&n.length&&d.map(function(e){n.map(function(t){var n=t.OrderExtendToken,r=t.ItemList,a=t.Content;e.OrderExtendToken===n&&(4!==e.Type&&5!==e.Type||!a?e.ItemList=Vt(e.ItemList,r):e.Content=a)})}),!0}});var F=null,X=null,G="\u8bf7\u9009\u62e9\u65e5\u671f",Q=G,q=function(e,t){var n=!1,r=!1;return 4===(4&e)?t>0&&(n=!0):r=!0,{isDisplayDate:r,isDoubleDate:n}}(m,D),J=q.isDisplayDate,W=q.isDoubleDate;W&&(F=function(e,t){for(var n=e.length,r=[],a=0;a<n-(t-1);a++)r.push(e[a]);return e=r}(L,D),A||B||(B=F[0]),J||(X=Xt(0,E,D,B,l)),61===y||99===y?Q="\u8fd8\u4ef6\u65e5\u671f":2===y&&(G="\u5f00\u59cb\u65e5\u671f",Q="\u7ed3\u675f\u65e5\u671f"));var V=en({selectedDate:B,Shoppings:l,BMStatus:m,CategoryId:y,isTradePrice:o}),Z=V.selectedCount,z=V.selectedPrice,$=V.selectedTradePrice,K=V.countList,ee=V.hasDate;A||(H=Z,ee||(B="")),W&&!J&&(z=Jt({selectedDate:B,selectedEndDate:U,Shoppings:l}),$=Wt({selectedDate:B,selectedEndDate:U,Shoppings:l})),h.push({BMStatus:m,DescInfo:Zt({Description:T,AddInfos:i}),CategoryId:y,CategoryName:b,ChargeUnit:S,ResourceName:k||I,Token:u,ResourceId:P||C,selectedDate:B,selectedCount:H,selectedPrice:z,selectedTradePrice:$,dateList:L,dateListProhibit:j,countList:K,Shoppings:l,isDoubleDate:W,isDisplayDate:J,startDateList:F,endDateList:X,selectedEndDate:U,OrderExtendInfos:d,MinBookingDays:D,MaxBookingDays:E,datePlaceHolder:G,endDatePlaceHolder:Q,SegmentId:p,MinAge:O,MaxAge:_,isOption:w,ResourceRelations:f,IsSingleResource:N,IsHotelShareRoom:R,IsChildNeedExtraPriceForNotShareRoom:x,ProductQuantityRules:M,isHide:0===z})}),g.map(function(e){var t="",n=[];h.map(function(r){r.CategoryId===e&&(t=r.CategoryName,n.push(r))}),i.push({CategoryName:t,CategoryId:e,list:n})}),i.map(function(e){var t=0;e.list.map(function(e){e.isHide&&t++}),t===e.list.length&&(e.isHide=!0)})}var y=function(e){var t=e.xTickets,n=e.TicketProducts,r=[];n&&n.length&&n.map(function(e){e.TicketResourceInfos.length&&r.push(e)});var a={};t.map(function(e){var t=e.Basic,n=t.TicketExtInfo,r=t.CityName,o=t.CountryName,i=t.ResourceName,c=t.BMStatus,s=t.ChargeUnit,u=t.CategoryId,l=t.ResourceId,d=t.Description,p=e.DefaultUseDate,f=e.AddInfos,m=n.POIId,h=n.ScenicSpotName,g=n.CommentCount,y=n.CommentGrade,v=n.ScenicSpotId,b=n.PeopleGroup,S=n.IsPreferential;e.TicketResourceBasicInfo={CategoryId:u,ProductId:l,Name:i,DefaultUseDate:p,BMStatus:c,Unit:s,AddInfos:f,Description:d,PeopleGroup:b,IsPreferential:S},a[m]||(a[m]={TicketResourceInfos:[]}),a[m].Name=h,a[m].CommentCount=g,a[m].CommentGrade=y,a[m].POIId=m,a[m].ScenicSpotId=v,a[m].CityInfo={CityName:r,CountryName:o},a[m].TicketResourceInfos.push(e)});var o=Object.keys(a),i=[];o.map(function(e){i.push(a[e])});var c=[];return(r.length||i.length)&&i.some(function(e){var t=!1;r.map(function(n){if(n.POIId===e.POIId)return n.TicketResourceInfos=[].concat(Qt(n.TicketResourceInfos),Qt(e.TicketResourceInfos)),t=!0,!0}),t||c.push(e)}),[].concat(r,c)}({xTickets:p,TicketProducts:s}),v=tn(y,t,o);return v||i.length?{resourceList:i,resourceListTicket:v}:{resourceEmpty:!0}},an=function(e){var t=e.resItem,n=e.data,r=e.isTradePrice,a=n.Token,o=n.type,i=n.value,c=!1;if(t.Token===a){var s=t.CategoryId,u=t.BMStatus,l=t.Shoppings,d=t.selectedCount,p=t.isDoubleDate,f=t.selectedDate,m=(t.endDateList,t.selectedEndDate,t.MaxBookingDays),h=t.MinBookingDays;t.dateList;if("count"===o)t.selectedCount=i;else if("startDate"===o)if(t.selectedDate=i,p)t.endDateList=Xt(0,m,h,i,l),t.selectedEndDate="",t.selectedPrice=Jt({selectedDate:i,selectedEndDate:"",Shoppings:l}),t.selectedTradePrice=Wt({selectedDate:i,selectedEndDate:"",Shoppings:l});else{var g=en({selectedDate:i,Shoppings:l,BMStatus:u,CategoryId:s,isTradePrice:r}),y=g.selectedPrice,v=g.selectedTradePrice,b=g.countList;t.selectedPrice=y,t.selectedTradePrice=v,t.countList=b,b.indexOf(d)<0&&(t.selectedCount=b[0])}else"endDate"===o&&(t.selectedEndDate=i,t.selectedPrice=Jt({selectedDate:f,selectedEndDate:i,Shoppings:l}),t.selectedTradePrice=Wt({selectedDate:f,selectedEndDate:i,Shoppings:l}));c=!0}return{changeState:c,nextRes:t}},on=function(e,t,n,r,a,o){if(bt(e))return{};var i=e.XItems,c=e.TicketProducts,s=e.OptionItems,u={XItems:i=qt({XItems:i,resourceListSelected:t}),OptionItems:s=qt({OptionItems:s,resourceListSelected:t}),TicketProducts:c},l=function(e,t,n,r){var a=e.XItems,o=e.OptionItems;n||a.map(function(e){e.Basic&&30===e.Basic.CategoryId||e.Shoppings.map(function(e){e.DefaultCount=0})});var i=[],c=[],s=[];o&&o.length&&o.map(function(e){var n=e.Token,r=e.Basic;t.some(function(t){if(n===t.Token){var r=t.SelectedCount,a=t.OrderExtendInfos,o=t.UseEndDate,i=t.UseStartDate;return e.SelectedCount=r,e.UseStartDate=It.parse(i).format("YYYY-MM-DD"),e.UseEndDate=It.parse(o).format("YYYY-MM-DD"),e.OrderExtendInfos.length&&a.length&&e.OrderExtendInfos.map(function(e){a.map(function(t){e.OrderExtendToken===t.OrderExtendToken&&(4===e.Type||5===e.Type&&t.Content?e.Content=t.Content:e.ItemList=Vt(e.ItemList,t.ItemList))})}),s.push(n),!0}}),Yt(r.BMStatus)&&c.push(e)}),a&&a.length&&a.map(function(e){var n=e.Token,r=e.Basic;t.some(function(t){if(n===t.Token)return e.UseDate=t.UseDate,e.SelectedCount=t.SelectedCount,e.Shoppings.some(function(e){if(It.parse(e.UseDate).getTime()===It.parse(t.UseDate).getTime())return e.SelectedCount=t.SelectedCount,!0}),s.push(n),!0}),Yt(r.BMStatus)&&i.push(e)});var u=[];s.length?t.map(function(e){var t=e.Token,n=!1;s.some(function(e){if(t===e)return n=!0,!0}),n||u.push(t)}):u=t.map(function(e){return e.Token});var l=i;return u.length&&i.length&&(l=[],i.map(function(e){var t=!1;u.map(function(n){n===e.Token&&(t=!0)}),t||l.push(e)})),{mustSelectRes:l,mustSelectOption:c,detailXItems:u}}(u,t,a),d=l.detailXItems,p=l.mustSelectRes,f=l.mustSelectOption,m=rn(u,t,n,0,r,o);return{resourceList:m.resourceList,resourceListTicket:m.resourceListTicket,detailXItems:d,mustSelectRes:p,mustSelectOption:f,startLoading:!1,resourceEmpty:m.resourceEmpty}},cn=function(e){var t=e.adultCount,n=e.childCount,r=e.childrenBedInfo,a=e.singleRoomBedInfo,o=e.otherResData,i=e.dfn,c=e.isShowTradePrice,s=function(e){var t=e.childrenBedInfo,n=e.singleRoomBedInfo,r=e.adultCount,a=e.childCount,o=n||{},i=o.IsHotelShareRoom,c=o.IsChildNeedExtraPriceForNotShareRoom,s=(o.selectedCount,o.Shoppings),u=o.Token,l=null;t&&(l=t.Shoppings[0],t.Token,t.SelectedCount);var d=!1,p=0,f=0,m=0,h=s[0].MaxCount,g=0;l&&(g=l.MaxCount);var y=function(e,t){var n=0;return e||t?e&&!t?n=2:!e&&t?n=3:e&&t&&(n=4):n=1,n}(i,c);1===y||2===y?(p=m=Math.ceil(r/2),f=h>=r-Gt([a,g])?r:Math.floor((Gt([a,g])+r+h)/2)):3!==y&&4!==y||(p=m=Math.ceil((r+a)/2),m>(f=h>=r-a?r:Math.floor((r+a+h)/2))&&(p=r,d=!0));var v=function(e){var t=e.min,n=e.max,r=e.step,a=e.sceneState,o=[];if(t%1===0||2!==a&&4!==a)for(var i=t;i<=n;)o.push(i),i+=r;else{o.push(t);for(var c=t+.5;c<=n;)o.push(c),c+=r}return o}({max:f,min:m,step:1,sceneState:y}),b=d?p:v[0];if(2===y&&a>0&&b<1){b=1;var S=[];v.map(function(e){e>=b&&S.push(e)}),v=S}return{countList:v,defCount:b,isConst:d,singleRoomToken:u,sceneState:y}}({childrenBedInfo:r,singleRoomBedInfo:a,adultCount:t,childCount:n}),u=s.countList,l=s.defCount,d=s.isConst,p=s.singleRoomToken,f=s.sceneState;o.map(function(e){30===e.CategoryId?e.isHide=!0:54===e.CategoryId&&r&&(e.isHide=!0)});var m=sn({count:l,state:f,singleRoomBedInfo:a,childrenBedInfo:r,isConst:d,dfn:i,adultCount:t,childCount:n,isShowTradePrice:c}),h=m.isShowTips,g=m.tipsHtml,y=m.singleCount,v=m.singleToken,b=m.childrenCount,S=m.childrenToken,T=m.spellRoom;return o.map(function(e){e.list.map(function(e){30===e.CategoryId&&e.Token===v?e.selectedCount=y:54===e.CategoryId&&e.Token===S&&(e.selectedCount=b)})}),o.push({CategoryId:-1,CategoryName:"\u623f\u95f4\u6570",singleRoomToken:p,tipsHtml:h?g:null,list:[{CategoryId:-1,ResourceName:"\u623f\u95f4\u6570",ChargeUnit:"\u95f4",countList:u,isDisplayDate:!0,selectedCount:l,statiCount:d,isRoom:!0}]}),{otherResData:o,childrenBedInfo:r,singleRoomBedInfo:a,sceneState:f,isConst:d,spellRoom:T}},sn=function(e){var t=e.count,n=e.state,r=e.singleRoomBedInfo,a=e.childrenBedInfo,o=e.isConst,i=e.dfn,c=e.adultCount,s=e.childCount,u=e.isShowTradePrice,l=r.Shoppings[0].UnitPrice.Price;u&&(l=r.Shoppings[0].UnitPrice.TradePrice);var d=r.Token,p=0,f=0,m=0;if(a){var h=a.Shoppings;p=h[0].UnitPrice.Price,u&&(p=h[0].UnitPrice.TradePrice),f=h[0].MaxCount,m=a.Token}var g='<i class="i_i3"></i>\u9700\u652f\u4ed8',y=!1,v=0,b=0;if(1===n||2===n)if(p<l){var S=p*(v=Gt([f,s,2*t-c])),T=l*(b=2*t-c-v),k=[];S&&k.push('<span class="color_orange">\u513f\u7ae5\u5360\u5e8a\u8d39'.concat(i).concat(S,"</span>")),T&&k.push('<span class="color_orange">\u623f\u5dee\u8d39'.concat(i,"</dfn>").concat(T,"</span>")),k.length&&(g+=k.join("\uff0c"),y=!0)}else{var P=(b=2*t-c)*l;P&&(g="".concat(g,'<span class="color_orange">\u623f\u5dee\u8d39').concat(i).concat(P,"</span>"),y=!0)}else if(3===n){var C=(b=o?0:2*t-c-s)*l;C&&(g="".concat(g,'<span class="color_orange">\u623f\u5dee\u8d39').concat(i).concat(C,"</span>"),y=!0)}if(4===n){var I=(b=o?0:2*t-c-s)*l;I&&(g="".concat(g,'<span class="color_orange">\u623f\u5dee\u8d39').concat(i).concat(I,"</span>"),y=!0)}t%1!==0&&(g="<i></i>1\u540d\u6210\u4eba\u9700\u8981\u4e0e\u540c\u6027\u56e2\u53cb\u62fc\u623f",y=!0);var D=!1;return r.IsChildNeedExtraPriceForNotShareRoom?(c+b+s)/2%1===.5&&(D=!0):(c+b+v)/2%1===.5&&(D=!0),{tipsHtml:g,isShowTips:y,singleCount:b,singleToken:d,childrenCount:v,childrenToken:m,count:t,spellRoom:D}},un=function(e){var t=e.Passengers,n=2,r=0;return t.map(function(e){var t=e.Type,a=e.Count;"Adult"===t?n=a:"Child"===t&&(r=a)}),{adultCount:n,childCount:r}},ln=function(e){var t=e.data,n=e.isTradePrice,r=null;try{var a=t.ResponseStatus,o=t.Data;"Success"===a.Ack&&(r=o.PriceDetail)}catch(O){}var i=r,c=i.TotalPrice,s=i.Others,u=i.Flight,l=i.Hotel,d=c.TotalPrice,p=d,f=c.Save;n&&(d=c.TotalTradePrice);var m=[];if(u){var h=u.Name,g=u.PriceType,y=u.TotalPrice,v=u.PriceList,b=y.TotalPrice,S=y.TradePrice,T=null;v&&v.length&&(T=[],v.map(function(e){var t=e.Name,r=e.Count,a=e.Price;"\u6210\u4eba\u7968"!==t&&"\u513f\u7ae5\u7968"!==t&&"\u5a74\u513f\u7968"!==t||T.push({name:t,count:r,price:n?a.TradePrice:a.Price})})),m.push({Name:h,PriceType:g,Price:n?S:b,details:T})}if(l){var k=l.Name,P=l.TotalPrice,C=l.PriceList,I=P.TotalPrice,D=P.TradePrice,E=null;C&&C.length&&(E=[],C.map(function(e){var t=e.Name,r=e.Count,a=e.Price,o=e.Days;E.push({name:t,count:r,price:n?a.TradePrice:a.Price,Days:o})})),m.push({Name:k,PriceType:-2,Price:n?D:I,details:E})}return s&&s.length&&s.map(function(e){var t=e.Name,r=e.PriceType,a=e.TotalPrice,o=e.PriceList,i=a.TotalPrice,c=a.TradePrice,s=i;n&&(s=c);var u=null;o&&o.length&&(u=[],o.map(function(e){var t=e.Name,a=e.Count,o=e.Price,i=e.Tags,c=o.TradePrice,s=o.Price,l=o.Original,d=n?c:s;2===r&&(d=l);var p=!1;i&&i.length&&(p=i.some(function(e){return"hotel_special"===e})),u.push({name:t,count:a,price:d,isHotelTag:p})})),m.push({Name:t,PriceType:r,Price:s,details:u})}),{totalPrice:d,defaultPrice:p,save:f,list:m}};function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){pn(e,t,n[t])})}return e}function pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fn={api:{},dfn:"<dfn>&yen;</dfn>",requestParam:{ChannelCode:0,PlatformId:4,Version:"71520"},html:{title:""},offlineDomain:"(order|package).*?ctripcorp.*?",bestDomain:"^(diybst|tourbst|bst).",bstChannel:{bestone:3,ctripshop:4,youtripshop:5,bestoneb2b:6},bstCookieName:{bstchannel:"bstchannel",Booking_TradeStatus:"Booking_TradeStatus",Union:"Union",unionMustValue:"allianceid=262681&sid=711462"},startLoading:!0,submitButton:{canBook:!0},isShowTicketLayer:!1,submitState:{isShowModal:!1},isShowBestoneTip:!1},mn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=(e.location.query.tour,e.ShoppingId);return dn({},e,Ht(t),{orderUrl:"/tour/booking/OrderV3?shoppingId=".concat(n)})},hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.resourceListSelected,r=e.XItemsShoppingDetail,a=e.TTDOptionItems,o=e.orderUrl,i=e.Passengers,c=e.dfn,s=e.isTradePrice,u=e.singleResourceIds,l=e.location.query.from,d=on(t,n,a,u,"detail"===l,s),p=d.resourceList,f=d.resourceListTicket,m=d.detailXItems,h=d.startLoading,g=d.mustSelectRes,y=d.mustSelectOption;if(d.resourceEmpty)return window.location=o,dn({},e);var v=function(e){var t=e.resourceList,n=(e.detailXItems,e.Passengers),r=e.dfn,a=e.isTradePrice,o=e.singleResourceIds,i=un({Passengers:n}),c=i.adultCount,s=i.childCount,u=[],l=[],d=[];if(t.map(function(e){var t=e.CategoryId,n=e.list;30===t?n.map(function(e){var t=e.BMStatus;Ft(t)||(e.ResourceRelations.length?d.push(e):l.push(e))}):54===t&&(u=n)}),!l.length&&!d.length)return{otherResData:t};if(l.length>1)return{otherResData:t};if(1!==l.length||d.length){var p=o,f=[];return d.some(function(e){return e.ResourceRelations.some(function(t){var n=t.ResourceRelationID;p.indexOf(n)>=0&&f.push(e)})}),0===f.length||f.length+l.length>1?{otherResData:t}:cn({adultCount:c,childCount:s,childrenBedInfo:u[0],singleRoomBedInfo:l[0]||f[0],otherResData:t,dfn:r,isShowTradePrice:a})}return cn({adultCount:c,childCount:s,childrenBedInfo:u[0],singleRoomBedInfo:l[0],otherResData:t,dfn:r,isShowTradePrice:a})}({resourceList:p,detailXItems:m,Passengers:i,dfn:c,isTradePrice:s,singleResourceIds:u}),b=v.otherResData,S=function(e){var t=e.XItemsShoppingDetail,n=e.detailXItems,r=[],a=[];return t.map(function(e){n.map(function(t){var n=e.Token,o=e.Basic,i=e.Shoppings;if(n===t){a.push(e);var c=o.ResourceName,s=o.BMStatus,u=o.ChargeUnit,l=o.ResourceId,d=o.CategoryId,p=o.IsSingleResource,f=o.IsChildNeedExtraPriceForNotShareRoom,m=o.IsHotelShareRoom,h=o.ProductQuantityRules;if(p){var g=i[0],y=g.SingleResourcePrices,v=g.MaxCount,b=g.UnitPrice,S=b.Save,T=b.Original,k="",P="",C="",I="",D="",E="";y&&y.length&&y.map(function(e){var t=e.PassengerType,n=e.SelectedCount,r=e.DetailPrice;"Adult"===t?(D=n,k=r.Price,P=r.TradePrice):"Child"===t&&(E=n,C=r.Price,I=r.TradePrice)}),r.push({Name:c,Token:n,ChargeUnit:u,ResourceId:l,BMStatus:s,CategoryId:d,IsSingleResource:p,IsChildNeedExtraPriceForNotShareRoom:f,IsHotelShareRoom:m,MaxCount:v,SelectedCount:D+E,AdultSelectedCount:D,Price:{Price:k,TradePrice:P,ChildPrice:C,ChildTradePrice:I,Save:S,Original:T},QuantityRules:h,ResourceType:1})}else{var O=i[0],_=O.MaxCount,w=O.SelectedCount,N=O.AdultSelectedCount,R=O.UnitPrice,x=R.Price,M=R.TradePrice,L=R.ChildPrice,j=R.ChildTradePrice,B=R.Save,A=R.Original;r.push({Name:c,Token:n,ChargeUnit:u,ResourceId:l,BMStatus:s,CategoryId:d,IsSingleResource:p,IsChildNeedExtraPriceForNotShareRoom:f,IsHotelShareRoom:m,MaxCount:_,SelectedCount:w,AdultSelectedCount:N,Price:{Price:x,TradePrice:M,ChildPrice:L,ChildTradePrice:j,Save:B,Original:A},QuantityRules:h,ResourceType:1})}}})}),{detailPrice:r,detailResource:a}}({XItemsShoppingDetail:r,detailXItems:m}),T=S.detailPrice,k=S.detailResource,P=function(e){var t=e.mustSelectRes,n=e.mustSelectOption,r=[],a=[];return t&&t.length&&t.map(function(e){var t=e.Basic,n=e.Shoppings,a=e.UseDate,o=e.SelectedCount,i=e.DefaultUseDate,c=e.Token,s={};i?n.some(function(e){if(It.parse(e.UseDate).getTime()===It.parse(a||i).getTime())return s=e,!0}):s=n[0];var u=t.ResourceName,l=t.BMStatus,d=t.ChargeUnit,p=t.ResourceId,f=t.CategoryId,m=t.IsSingleResource,h=t.IsChildNeedExtraPriceForNotShareRoom,g=t.IsHotelShareRoom,y=t.ProductQuantityRules,v=s,b=v.MaxCount,S=v.UnitPrice,T=S.Save,k=S.Original,P=v.SingleResourcePrices,C="",I="",D="",E="",O="",_="";if(m&&P&&P.length)P.map(function(e){var t=e.PassengerType,n=e.SelectedCount,r=e.DetailPrice;"Adult"===t?(O=n,C=r.Price,I=r.TradePrice):"Child"===t&&(_=n,D=r.Price,E=r.TradePrice)}),r.push({Name:u,Token:c,ChargeUnit:d,ResourceId:p,BMStatus:l,CategoryId:f,IsSingleResource:m,IsChildNeedExtraPriceForNotShareRoom:h,IsHotelShareRoom:g,MaxCount:b,SelectedCount:O+_,AdultSelectedCount:O,Price:{Price:C,TradePrice:I,ChildPrice:D,ChildTradePrice:E,Save:T,Original:k},QuantityRules:y,ResourceType:1});else{var w=s,N=w.DefaultCount,R=w.SelectedCount,x=w.MaxCount,M=w.AdultSelectedCount,L=w.UnitPrice,j=L.Price,B=L.TradePrice,A=L.ChildPrice,U=L.ChildTradePrice,H=L.Save,Y=L.Original,F=o||N||R;F>0&&r.push({Name:u,Token:c,ChargeUnit:d,ResourceId:p,BMStatus:l,CategoryId:f,IsSingleResource:m,IsChildNeedExtraPriceForNotShareRoom:h,IsHotelShareRoom:g,MaxCount:x,SelectedCount:F,AdultSelectedCount:M,QuantityRules:y,Price:{Price:j,TradePrice:B,ChildPrice:A,ChildTradePrice:U,Save:H,Original:Y},ResourceType:1})}}),n&&n.length&&n.map(function(e){var t=e.UseStartDate,n=e.UseEndDate,r=e.SelectedCount,o=e.Basic,i=e.Token,c=e.Shoppings,s=Nt({Shoppings:c,selectedDate:t,selectedEndDate:n}).PriceList;if(r>0){var u=o.OptionName,l=o.ChargeUnit,d=o.BMStatus,p=o.MinBookingDays;a.push({Name:u,Token:i,ChargeUnit:l,BMStatus:d,SelectedCount:r,UseStartDate:t,UseEndDate:n||t,PriceInfo:s,MinBookingDays:p})}}),{mustPriceList:r,mustOptionPrice:a}}({mustSelectRes:g,mustSelectOption:y});return dn({},e,{resourceList:b,resourceListTicket:f,startLoading:h,detailPriceList:T,mustPriceList:P.mustPriceList,mustOptionPrice:P.mustOptionPrice,mustSelectOption:y,bedRoomInfo:v,mustSelectRes:g,XItemsShoppingDetail:k})},gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.resourceList,r=e.resourceListTicket,a=e.bedRoomInfo,o=e.dfn,i=e.isTradePrice,c=e.Passengers,s=(t.Token,t.type,t.value),u=t.resourceType;if("ticket"===u)r.sceneryList.map(function(e){e.tickList.otherList.length&&e.tickList.otherList.map(function(e){e&&e.length&&e.some(function(e){var n=an({resItem:e,data:t,isTradePrice:i}),r=n.changeState,a=n.nextRes;if(r)return e=a,!0})}),e.tickList.specialList&&e.tickList.specialList.some(function(e){var n=an({resItem:e,data:t,isTradePrice:i}),r=n.changeState,a=n.nextRes;if(r)return e=a,!0})});else if("room"===u){var l=a.isConst,d=a.childrenBedInfo,p=a.sceneState,f=a.singleRoomBedInfo,m=un({Passengers:c}),h=m.adultCount,g=m.childCount,y=sn({count:s,state:p,singleRoomBedInfo:f,childrenBedInfo:d,isConst:l,dfn:o,adultCount:h,childCount:g,isShowTradePrice:i}),v=y.isShowTips,b=y.tipsHtml,S=y.singleCount,T=y.singleToken,k=y.childrenCount,P=y.childrenToken;y.spellRoom;n.map(function(e){-1===e.CategoryId?(e.tipsHtml=v?b:"",e.list[0].selectedCount=s):30===e.CategoryId&&T?e.list.some(function(e){if(e.Token===T)return e.selectedCount=S,!0}):54===e.CategoryId&&P&&e.list.some(function(e){if(e.Token===P)return e.selectedCount=k,!0})})}else n.some(function(e){return e.list.some(function(e){var n=an({resItem:e,data:t,isTradePrice:i}),r=n.changeState,a=n.nextRes;if(r)return e=a,!0})});return dn({},e,{resourceList:n})},yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.resourceList,r=t.Token,a=t.OrderExtendToken,o=t.OrderExtendItemToken,i=(t.Type,t.Content),c=t.selectList;return n.some(function(e){e.list.some(function(e){if(e.Token===r)return e.OrderExtendInfos.some(function(e){if(e.OrderExtendToken===a)return 4===e.Type||5===e.Type?e.Content=i:2===e.Type?c.map(function(t){e.ItemList.map(function(e){t.OrderExtendItemToken===e.OrderExtendItemToken&&(e.IsDefault=t.IsDefault)})}):e.ItemList.map(function(e){e.OrderExtendItemToken===o?e.IsDefault=!0:e.IsDefault=!1}),!0}),!0})}),dn({},e,{resourceList:n})},vn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.isTradePrice;return dn({},e,{PriceDetail:ln({data:t,isTradePrice:n})})},bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.ResponseStatus,r=t.Data,a=e.submitState,o=e.submitButton,i=e.orderUrl;if("Success"===n.Ack&&r.IsSuccess)window.location.href=i+"&from=optionNew",o.canBook=!1;else{var c=r.ShoppingUpdateInfo;a=dn({},a,{ResourceStatus:c.ResourceStatus,SupplyList:c.SupplyList,isShowModal:!0}),o.canBook=!0}return dn({},e,{submitButton:o,submitState:a})},Sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments.length>1&&arguments[1],e.submitButton);return t.canBook=!0,dn({},e,{submitButton:t})},Tn=function(e){var t=e.Route,n=e.Hotels,r=[];t&&t.Segments&&t.Segments.length&&t.Segments.map(function(e){var t=e.SegmentId,n=e.PriceInfos,a="";n&&n.length&&(a=n[0].Token),r.push({SegmentId:t,Token:a})});var a=[];return n&&n.length&&n.map(function(e){var t=e.Token,n=e.ShoppingInfo,r=e.Rooms[0],o=r.Token,i=r.Shopping;a.push({SegmentId:n.SegmentId,HotelToken:t,Token:o,Count:i.DefaultCount})}),[].concat(r,a)},kn=function(){var e=cQuery(".input_error");if(e.length){var t=e[0],n=cQuery(t).offset().top-10;window.scrollTo(0,n)}},Pn=function(e,t){var n=t.pageId,r=t.messageid,a=t.message,o=t.sys_message,i=t.operation,c=t.businessline;e("vacation_usershoppinginterruption_vac",{merchandiseid:t.ProductId,businessline:c||"sdp",operation:i||"\u4e0b\u4e00\u6b65\uff1a\u586b\u5199\u4fe1\u606f",pageid:n,messageid:r,message:a,sys_message:o})};function Cn(e){return(Cn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Rn(e,t,n[t])})}return e}function Dn(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}function En(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){Dn(o,r,a,i,c,"next",e)}function c(e){Dn(o,r,a,i,c,"throw",e)}i(void 0)})}}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nn(e,t){return(Nn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"default",function(){return Ln});var xn=fn,Mn=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r,["initialState"]),Ln=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return r=this,a=(e=_n(t)).call.apply(e,[this].concat(i)),n=!a||"object"!==Cn(a)&&"function"!==typeof a?wn(r):a,Rn(wn(n),"View",vt),Rn(wn(n),"initialState",xn),Rn(wn(n),"actions",Mn),Rn(wn(n),"getBasicData",En(regeneratorRuntime.mark(function e(){var t,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.store.getState(),r=t.requestParam,a=t.ShoppingId,e.next=4,n.fetch("/online/10705/ShoppingDetailGet.json",{method:"POST",body:JSON.stringify(In({},r,{ShoppingId:a}))});case 4:o=e.sent,n.store.actions.FORMAT_SHOPPINT_DETAILGET(o);case 6:case"end":return e.stop()}},e)}))),Rn(wn(n),"getResourceList",En(regeneratorRuntime.mark(function e(){var t,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.store.getState(),r=t.requestParam,a=t.ShoppingId,e.next=4,n.fetch("/online/10705/XSearch",{method:"POST",body:JSON.stringify(In({},r,{ShoppingId:a,ActionType:6,Channel:1,Version:"7152"}))});case 4:o=e.sent,n.store.actions.FORMAT_XSEARCH(o);case 6:case"end":return e.stop()}},e)}))),Rn(wn(n),"handleCountDateChange",function(e){n.store.actions.COUNT_DATE_CHANGE(e),n.updataPrice()}),Rn(wn(n),"handleExtendChange",function(e){n.store.actions.EXTEND_CHANGE(e)}),Rn(wn(n),"handleSubmit",En(regeneratorRuntime.mark(function e(){var t,r,a,o,i,c,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.store.getState(),r=jt(t)){e.next=6;break}return n.store.actions.SUBMIT_DATA_ERROR(),kn(),e.abrupt("return",!1);case 6:if(r.ShoppingDetailUpdateRequest.SelectedResources.length){e.next=15;break}if(!(a=Tn(t)).length){e.next=12;break}r.ShoppingDetailUpdateRequest.SelectedResources=a,e.next=15;break;case 12:return o=t.orderUrl,window.location.href=o+"&from=optionNew",e.abrupt("return",!1);case 15:return e.prev=15,e.next=18,n.fetch("/online/13592/BookingResource",{method:"POST",body:JSON.stringify(r)});case 18:i=e.sent,n.store.actions.SUBMIT(i),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(15),c=t.pageId,s=t.isSdp,u=t.ProductId,Pn(n.traceLog,{ProductId:u,pageId:c,messageid:"vac_0078",message:"",sys_message:"",businessline:s?"sdp":"dp"});case 26:case"end":return e.stop()}},e,null,[[15,22]])}))),Rn(wn(n),"updataPrice",En(regeneratorRuntime.mark(function e(){var t,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.store.getState(),r=Rt(t),e.next=4,n.fetch("/online/13592/GetResourcePriceDetail",{method:"POST",body:JSON.stringify(r)});case 4:a=e.sent,n.store.actions.FORMAT_PRICE_DETAIL(a);case 6:case"end":return e.stop()}},e)}))),Rn(wn(n),"handleToggleTicketModal",function(e){(0,n.store.actions.UPDATE_STATE)(In({},e))}),Rn(wn(n),"handleSceneryInfo",function(){var e=En(regeneratorRuntime.mark(function e(t){var r,a,o,i,c,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.POIId,a=t.ScenicSpotId,o=t.callBack,i=t.imageCount,c=t.count,s=null,!r||!a){e.next=6;break}return e.next=5,n.fetch("/online/13592/getPOIInfo.json",{method:"POST",body:JSON.stringify({count:c,start:1,imageCount:i,imageSize:"C_900_504",poiId:r,scenicSpotId:a})});case 5:s=e.sent;case 6:o(s);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Rn(wn(n),"handlerCloseSceneryLayer",function(){(0,n.store.actions.UPDATE_STATE)({ticketLayer:{showLoading:!1}})}),Rn(wn(n),"handleChangeBestoneType",function(e){var t=n.store.actions.UPDATE_STATE,r=n.store.getState().isBestone,a=1==e?"TradePrice":"RecommendPrice",o=location.host.split(":")[0].split(".").slice(-2).join("."),i={expires:new Date(Date.now()+864e5),domain:o};n.setCookie("Booking_TradeStatus",a,i),t({bestoneType:e,isTradePrice:r&&1===e}),n.updataPrice()}),Rn(wn(n),"handleCloseModal",function(){var e=n.store.actions.UPDATE_STATE,t=n.store.getState().submitState;t.isShowModal=!1,t.SupplyList=null,e({submitState:t})}),Rn(wn(n),"handleResourceRendered",function(){(0,n.store.actions.UPDATE_STATE)({hasRendered:!0})}),Rn(wn(n),"handleBestoneChannelCheckTip",function(){(0,n.store.actions.UPDATE_STATE)({isShowBestoneTip:!0})}),Rn(wn(n),"handleBestoneChannelHideTip",function(){(0,n.store.actions.UPDATE_STATE)({isShowBestoneTip:!1})}),n}var n,r,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nn(e,t)}(t,a["a"]),n=t,(r=[{key:"shouldComponentCreate",value:function(){var e=En(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillCreate",value:function(){var e=En(regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,c,s,u,l,d,p,f,m,h,g,y,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.store.getState(),n=t.requestParam,r=t.bstCookieName,a=t.location,o=this.store.actions.UPDATE_STATE,i=a.query,c=i.shoppingId,s=i.ShoppingId,u=i.shoppingid,l=i.isoffline,i.isBestone,s=s||c||u,d=new RegExp(t.bestDomain).test(this.getHost()),p={},!d){e.next=11;break}return e.next=10,this.fetchBestoneStore();case 10:p=e.sent;case 11:f=this.getCookie(r.Booking_TradeStatus),m="TradePrice"==f?1:2,h=this.getCookie(r.bstchannel),g=h?t.bstChannel[h.toLowerCase()]:4,y=d?g:0,n.ChannelCode=y,"(order|package).*?ctripcorp.*?",v=l&&"true"===l.toLowerCase()||new RegExp("(order|package).*?ctripcorp.*?").test(this.getHost()),n.ChannelCode=d?g:0,n.PlatformId=v?5:4,o({isBestone:d,bestoneStore:p,bestoneType:m,requestParam:n,ShoppingId:s,ChannelCode:y,isOffline:v,isTradePrice:d&&1===m});case 22:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=En(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.store.actions.UPDATE_STATE,n=document.getElementById("page_id").value,t({pageId:n}),e.next=5,this.getBasicData();case 5:return e.next=7,this.getResourceList();case 7:this.updataPrice();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUpdate",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"getHost",value:function(){return this.context.isServer?this.context.req.headers.host:window.location.host}},{key:"fetchBestoneStore",value:function(){var e=En(regeneratorRuntime.mark(function e(){var t,n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.prev=1,e.next=4,this.fetch("/online/12328/queryBestoneStore.json",{method:"GET"});case 4:n=e.sent,a=(r=n||{}).ResponseStatus,o=r.bestoneStoreList,n&&a&&"Success"===a.Ack&&(t=o[0]),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}()}])&&On(n.prototype,r),o&&On(n,o),t}()}}]);